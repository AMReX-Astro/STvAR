#ifndef ET_INTEGRATION_CONSTRAINTS_K_H 
#define ET_INTEGRATION_CONSTRAINTS_K_H 

#include <AMReX_REAL.H> 
#include <AMReX_Array4.H> 
#include <ET_Integration_Setup.H> 

AMREX_GPU_DEVICE 
inline 
void 
state_diagnostics(int i, int j, int k, 
        amrex::Array4<amrex::Real> const& diag, 
        amrex::Array4<amrex::Real const> const& state_fab, 
        amrex::GpuArray<amrex::Real,AMREX_SPACEDIM> const& dx) noexcept 
{
         amrex::Real phi = state_fab(i, j, k, Idx::phi);
         amrex::Real gambar00 = state_fab(i, j, k, Idx::gambar00);
         amrex::Real gambar01 = state_fab(i, j, k, Idx::gambar01);
         amrex::Real gambar02 = state_fab(i, j, k, Idx::gambar02);
         amrex::Real gambar10 = state_fab(i, j, k, Idx::gambar01);
         amrex::Real gambar11 = state_fab(i, j, k, Idx::gambar11);
         amrex::Real gambar12 = state_fab(i, j, k, Idx::gambar12);
         amrex::Real gambar20 = state_fab(i, j, k, Idx::gambar02);
         amrex::Real gambar21 = state_fab(i, j, k, Idx::gambar12);
         amrex::Real gambar22 = state_fab(i, j, k, Idx::gambar22);
	 amrex::Real Ksclr = state_fab(i, j, k, Idx::Ksclr);
	 amrex::Real Abar00 = state_fab(i, j, k, Idx::Abar00);
         amrex::Real Abar01 = state_fab(i, j, k, Idx::Abar01);
         amrex::Real Abar02 = state_fab(i, j, k, Idx::Abar02);
         amrex::Real Abar10 = state_fab(i, j, k, Idx::Abar01);
         amrex::Real Abar11 = state_fab(i, j, k, Idx::Abar11);
         amrex::Real Abar12 = state_fab(i, j, k, Idx::Abar12);
         amrex::Real Abar20 = state_fab(i, j, k, Idx::Abar02);
         amrex::Real Abar21 = state_fab(i, j, k, Idx::Abar12);
         amrex::Real Abar22 = state_fab(i, j, k, Idx::Abar22);
	 amrex::Real GambarU0 = state_fab(i, j, k, Idx::GambarU0);
         amrex::Real GambarU1 = state_fab(i, j, k, Idx::GambarU1);
         amrex::Real GambarU2 = state_fab(i, j, k, Idx::GambarU2);
	 amrex::Real gambarinv00 = (gambar11*gambar22 - gambar12*gambar21)/(gambar00*gambar11*gambar22 - gambar00*gambar12*gambar21 - gambar01*gambar10*gambar22 + gambar01*gambar12*gambar20 + gambar02*gambar10*gambar21 - gambar02*gambar11*gambar20);
         amrex::Real gambarinv01 = (-gambar01*gambar22 + gambar02*gambar21)/(gambar00*gambar11*gambar22 - gambar00*gambar12*gambar21 - gambar01*gambar10*gambar22 + gambar01*gambar12*gambar20 + gambar02*gambar10*gambar21 - gambar02*gambar11*gambar20);
         amrex::Real gambarinv02 = (gambar01*gambar12 - gambar02*gambar11)/(gambar00*gambar11*gambar22 - gambar00*gambar12*gambar21 - gambar01*gambar10*gambar22 + gambar01*gambar12*gambar20 + gambar02*gambar10*gambar21 - gambar02*gambar11*gambar20);
         amrex::Real gambarinv10 = (-gambar10*gambar22 + gambar12*gambar20)/(gambar00*gambar11*gambar22 - gambar00*gambar12*gambar21 - gambar01*gambar10*gambar22 + gambar01*gambar12*gambar20 + gambar02*gambar10*gambar21 - gambar02*gambar11*gambar20);
         amrex::Real gambarinv11 = gambar00*(gambar00*gambar22 - gambar02*gambar20)/((gambar00*gambar11 - gambar01*gambar10)*(gambar00*gambar22 - gambar02*gambar20) - (gambar00*gambar12 - gambar02*gambar10)*(gambar00*gambar21 - gambar01*gambar20));
         amrex::Real gambarinv12 = -gambar00*(gambar00*gambar12 - gambar02*gambar10)/((gambar00*gambar11 - gambar01*gambar10)*(gambar00*gambar22 - gambar02*gambar20) - (gambar00*gambar12 - gambar02*gambar10)*(gambar00*gambar21 - gambar01*gambar20));
         amrex::Real gambarinv20 = (gambar10*gambar21 - gambar11*gambar20)/(gambar00*gambar11*gambar22 - gambar00*gambar12*gambar21 - gambar01*gambar10*gambar22 + gambar01*gambar12*gambar20 + gambar02*gambar10*gambar21 - gambar02*gambar11*gambar20);
         amrex::Real gambarinv21 = -gambar00*(gambar00*gambar21 - gambar01*gambar20)/((gambar00*gambar11 - gambar01*gambar10)*(gambar00*gambar22 - gambar02*gambar20) - (gambar00*gambar12 - gambar02*gambar10)*(gambar00*gambar21 - gambar01*gambar20));
         amrex::Real gambarinv22 = gambar00*(gambar00*gambar11 - gambar01*gambar10)/((gambar00*gambar11 - gambar01*gambar10)*(gambar00*gambar22 - gambar02*gambar20) - (gambar00*gambar12 - gambar02*gambar10)*(gambar00*gambar21 - gambar01*gambar20));
	 amrex::Real dphi0 = ((1.0/2.0)*state_fab(i + 1, j, k, Idx::phi) - 1.0/2.0*state_fab(i - 1, j, k, Idx::phi))/dx[0];
         amrex::Real dphi1 = ((1.0/2.0)*state_fab(i, j + 1, k, Idx::phi) - 1.0/2.0*state_fab(i, j - 1, k, Idx::phi))/dx[1];
         amrex::Real dphi2 = ((1.0/2.0)*state_fab(i, j, k + 1, Idx::phi) - 1.0/2.0*state_fab(i, j, k - 1, Idx::phi))/dx[2];
         amrex::Real ddphi00 = (state_fab(i + 1, j, k, Idx::phi) + state_fab(i - 1, j, k, Idx::phi) - 2*state_fab(i, j, k, Idx::phi))/std::pow(dx[0], 2);
         amrex::Real ddphi01 = ((1.0/4.0)*state_fab(i + 1, j + 1, k, Idx::phi) - 1.0/4.0*state_fab(i + 1, j - 1, k, Idx::phi) - 1.0/4.0*state_fab(i - 1, j + 1, k, Idx::phi) + (1.0/4.0)*state_fab(i - 1, j - 1, k, Idx::phi))/(dx[0]*dx[1]);
         amrex::Real ddphi02 = ((1.0/4.0)*state_fab(i + 1, j, k + 1, Idx::phi) - 1.0/4.0*state_fab(i + 1, j, k - 1, Idx::phi) - 1.0/4.0*state_fab(i - 1, j, k + 1, Idx::phi) + (1.0/4.0)*state_fab(i - 1, j, k - 1, Idx::phi))/(dx[0]*dx[2]);
         amrex::Real ddphi10 = ((1.0/4.0)*state_fab(i + 1, j + 1, k, Idx::phi) - 1.0/4.0*state_fab(i + 1, j - 1, k, Idx::phi) - 1.0/4.0*state_fab(i - 1, j + 1, k, Idx::phi) + (1.0/4.0)*state_fab(i - 1, j - 1, k, Idx::phi))/(dx[0]*dx[1]);
         amrex::Real ddphi11 = (state_fab(i, j + 1, k, Idx::phi) + state_fab(i, j - 1, k, Idx::phi) - 2*state_fab(i, j, k, Idx::phi))/std::pow(dx[1], 2);
         amrex::Real ddphi12 = ((1.0/4.0)*state_fab(i, j + 1, k + 1, Idx::phi) - 1.0/4.0*state_fab(i, j + 1, k - 1, Idx::phi) - 1.0/4.0*state_fab(i, j - 1, k + 1, Idx::phi) + (1.0/4.0)*state_fab(i, j - 1, k - 1, Idx::phi))/(dx[1]*dx[2]);
         amrex::Real ddphi20 = ((1.0/4.0)*state_fab(i + 1, j, k + 1, Idx::phi) - 1.0/4.0*state_fab(i + 1, j, k - 1, Idx::phi) - 1.0/4.0*state_fab(i - 1, j, k + 1, Idx::phi) + (1.0/4.0)*state_fab(i - 1, j, k - 1, Idx::phi))/(dx[0]*dx[2]);
         amrex::Real ddphi21 = ((1.0/4.0)*state_fab(i, j + 1, k + 1, Idx::phi) - 1.0/4.0*state_fab(i, j + 1, k - 1, Idx::phi) - 1.0/4.0*state_fab(i, j - 1, k + 1, Idx::phi) + (1.0/4.0)*state_fab(i, j - 1, k - 1, Idx::phi))/(dx[1]*dx[2]);
         amrex::Real ddphi22 = (state_fab(i, j, k + 1, Idx::phi) + state_fab(i, j, k - 1, Idx::phi) - 2*state_fab(i, j, k, Idx::phi))/std::pow(dx[2], 2);
	 amrex::Real dgambar000 = ((1.0/2.0)*state_fab(i + 1, j, k, Idx::gambar00) - 1.0/2.0*state_fab(i - 1, j, k, Idx::gambar00))/dx[0];
         amrex::Real dgambar001 = ((1.0/2.0)*state_fab(i, j + 1, k, Idx::gambar00) - 1.0/2.0*state_fab(i, j - 1, k, Idx::gambar00))/dx[1];
         amrex::Real dgambar002 = ((1.0/2.0)*state_fab(i, j, k + 1, Idx::gambar00) - 1.0/2.0*state_fab(i, j, k - 1, Idx::gambar00))/dx[2];
         amrex::Real dgambar010 = ((1.0/2.0)*state_fab(i + 1, j, k, Idx::gambar01) - 1.0/2.0*state_fab(i - 1, j, k, Idx::gambar01))/dx[0];
         amrex::Real dgambar011 = ((1.0/2.0)*state_fab(i, j + 1, k, Idx::gambar01) - 1.0/2.0*state_fab(i, j - 1, k, Idx::gambar01))/dx[1];
         amrex::Real dgambar012 = ((1.0/2.0)*state_fab(i, j, k + 1, Idx::gambar01) - 1.0/2.0*state_fab(i, j, k - 1, Idx::gambar01))/dx[2];
         amrex::Real dgambar020 = ((1.0/2.0)*state_fab(i + 1, j, k, Idx::gambar02) - 1.0/2.0*state_fab(i - 1, j, k, Idx::gambar02))/dx[0];
         amrex::Real dgambar021 = ((1.0/2.0)*state_fab(i, j + 1, k, Idx::gambar02) - 1.0/2.0*state_fab(i, j - 1, k, Idx::gambar02))/dx[1];
         amrex::Real dgambar022 = ((1.0/2.0)*state_fab(i, j, k + 1, Idx::gambar02) - 1.0/2.0*state_fab(i, j, k - 1, Idx::gambar02))/dx[2];
         amrex::Real dgambar100 = ((1.0/2.0)*state_fab(i + 1, j, k, Idx::gambar01) - 1.0/2.0*state_fab(i - 1, j, k, Idx::gambar01))/dx[0];
         amrex::Real dgambar101 = ((1.0/2.0)*state_fab(i, j + 1, k, Idx::gambar01) - 1.0/2.0*state_fab(i, j - 1, k, Idx::gambar01))/dx[1];
         amrex::Real dgambar102 = ((1.0/2.0)*state_fab(i, j, k + 1, Idx::gambar01) - 1.0/2.0*state_fab(i, j, k - 1, Idx::gambar01))/dx[2];
         amrex::Real dgambar110 = ((1.0/2.0)*state_fab(i + 1, j, k, Idx::gambar11) - 1.0/2.0*state_fab(i - 1, j, k, Idx::gambar11))/dx[0];
         amrex::Real dgambar111 = ((1.0/2.0)*state_fab(i, j + 1, k, Idx::gambar11) - 1.0/2.0*state_fab(i, j - 1, k, Idx::gambar11))/dx[1];
         amrex::Real dgambar112 = ((1.0/2.0)*state_fab(i, j, k + 1, Idx::gambar11) - 1.0/2.0*state_fab(i, j, k - 1, Idx::gambar11))/dx[2];
         amrex::Real dgambar120 = ((1.0/2.0)*state_fab(i + 1, j, k, Idx::gambar12) - 1.0/2.0*state_fab(i - 1, j, k, Idx::gambar12))/dx[0];
         amrex::Real dgambar121 = ((1.0/2.0)*state_fab(i, j + 1, k, Idx::gambar12) - 1.0/2.0*state_fab(i, j - 1, k, Idx::gambar12))/dx[1];
         amrex::Real dgambar122 = ((1.0/2.0)*state_fab(i, j, k + 1, Idx::gambar12) - 1.0/2.0*state_fab(i, j, k - 1, Idx::gambar12))/dx[2];
         amrex::Real dgambar200 = ((1.0/2.0)*state_fab(i + 1, j, k, Idx::gambar02) - 1.0/2.0*state_fab(i - 1, j, k, Idx::gambar02))/dx[0];
         amrex::Real dgambar201 = ((1.0/2.0)*state_fab(i, j + 1, k, Idx::gambar02) - 1.0/2.0*state_fab(i, j - 1, k, Idx::gambar02))/dx[1];
         amrex::Real dgambar202 = ((1.0/2.0)*state_fab(i, j, k + 1, Idx::gambar02) - 1.0/2.0*state_fab(i, j, k - 1, Idx::gambar02))/dx[2];
         amrex::Real dgambar210 = ((1.0/2.0)*state_fab(i + 1, j, k, Idx::gambar12) - 1.0/2.0*state_fab(i - 1, j, k, Idx::gambar12))/dx[0];
         amrex::Real dgambar211 = ((1.0/2.0)*state_fab(i, j + 1, k, Idx::gambar12) - 1.0/2.0*state_fab(i, j - 1, k, Idx::gambar12))/dx[1];
         amrex::Real dgambar212 = ((1.0/2.0)*state_fab(i, j, k + 1, Idx::gambar12) - 1.0/2.0*state_fab(i, j, k - 1, Idx::gambar12))/dx[2];
         amrex::Real dgambar220 = ((1.0/2.0)*state_fab(i + 1, j, k, Idx::gambar22) - 1.0/2.0*state_fab(i - 1, j, k, Idx::gambar22))/dx[0];
         amrex::Real dgambar221 = ((1.0/2.0)*state_fab(i, j + 1, k, Idx::gambar22) - 1.0/2.0*state_fab(i, j - 1, k, Idx::gambar22))/dx[1];
         amrex::Real dgambar222 = ((1.0/2.0)*state_fab(i, j, k + 1, Idx::gambar22) - 1.0/2.0*state_fab(i, j, k - 1, Idx::gambar22))/dx[2];
	 amrex::Real ddgambar0000 = (state_fab(i + 1, j, k, Idx::gambar00) + state_fab(i - 1, j, k, Idx::gambar00) - 2*state_fab(i, j, k, Idx::gambar00))/std::pow(dx[0], 2);
         amrex::Real ddgambar0001 = ((1.0/4.0)*state_fab(i + 1, j + 1, k, Idx::gambar00) - 1.0/4.0*state_fab(i + 1, j - 1, k, Idx::gambar00) - 1.0/4.0*state_fab(i - 1, j + 1, k, Idx::gambar00) + (1.0/4.0)*state_fab(i - 1, j - 1, k, Idx::gambar00))/(dx[0]*dx[1]);
         amrex::Real ddgambar0002 = ((1.0/4.0)*state_fab(i + 1, j, k + 1, Idx::gambar00) - 1.0/4.0*state_fab(i + 1, j, k - 1, Idx::gambar00) - 1.0/4.0*state_fab(i - 1, j, k + 1, Idx::gambar00) + (1.0/4.0)*state_fab(i - 1, j, k - 1, Idx::gambar00))/(dx[0]*dx[2]);
         amrex::Real ddgambar0010 = ((1.0/4.0)*state_fab(i + 1, j + 1, k, Idx::gambar00) - 1.0/4.0*state_fab(i + 1, j - 1, k, Idx::gambar00) - 1.0/4.0*state_fab(i - 1, j + 1, k, Idx::gambar00) + (1.0/4.0)*state_fab(i - 1, j - 1, k, Idx::gambar00))/(dx[0]*dx[1]);
         amrex::Real ddgambar0011 = (state_fab(i, j + 1, k, Idx::gambar00) + state_fab(i, j - 1, k, Idx::gambar00) - 2*state_fab(i, j, k, Idx::gambar00))/std::pow(dx[1], 2);
         amrex::Real ddgambar0012 = ((1.0/4.0)*state_fab(i, j + 1, k + 1, Idx::gambar00) - 1.0/4.0*state_fab(i, j + 1, k - 1, Idx::gambar00) - 1.0/4.0*state_fab(i, j - 1, k + 1, Idx::gambar00) + (1.0/4.0)*state_fab(i, j - 1, k - 1, Idx::gambar00))/(dx[1]*dx[2]);
         amrex::Real ddgambar0020 = ((1.0/4.0)*state_fab(i + 1, j, k + 1, Idx::gambar00) - 1.0/4.0*state_fab(i + 1, j, k - 1, Idx::gambar00) - 1.0/4.0*state_fab(i - 1, j, k + 1, Idx::gambar00) + (1.0/4.0)*state_fab(i - 1, j, k - 1, Idx::gambar00))/(dx[0]*dx[2]);
         amrex::Real ddgambar0021 = ((1.0/4.0)*state_fab(i, j + 1, k + 1, Idx::gambar00) - 1.0/4.0*state_fab(i, j + 1, k - 1, Idx::gambar00) - 1.0/4.0*state_fab(i, j - 1, k + 1, Idx::gambar00) + (1.0/4.0)*state_fab(i, j - 1, k - 1, Idx::gambar00))/(dx[1]*dx[2]);
         amrex::Real ddgambar0022 = (state_fab(i, j, k + 1, Idx::gambar00) + state_fab(i, j, k - 1, Idx::gambar00) - 2*state_fab(i, j, k, Idx::gambar00))/std::pow(dx[2], 2);
         amrex::Real ddgambar0100 = (state_fab(i + 1, j, k, Idx::gambar01) + state_fab(i - 1, j, k, Idx::gambar01) - 2*state_fab(i, j, k, Idx::gambar01))/std::pow(dx[0], 2);
         amrex::Real ddgambar0101 = ((1.0/4.0)*state_fab(i + 1, j + 1, k, Idx::gambar01) - 1.0/4.0*state_fab(i + 1, j - 1, k, Idx::gambar01) - 1.0/4.0*state_fab(i - 1, j + 1, k, Idx::gambar01) + (1.0/4.0)*state_fab(i - 1, j - 1, k, Idx::gambar01))/(dx[0]*dx[1]);
         amrex::Real ddgambar0102 = ((1.0/4.0)*state_fab(i + 1, j, k + 1, Idx::gambar01) - 1.0/4.0*state_fab(i + 1, j, k - 1, Idx::gambar01) - 1.0/4.0*state_fab(i - 1, j, k + 1, Idx::gambar01) + (1.0/4.0)*state_fab(i - 1, j, k - 1, Idx::gambar01))/(dx[0]*dx[2]);
         amrex::Real ddgambar0110 = ((1.0/4.0)*state_fab(i + 1, j + 1, k, Idx::gambar01) - 1.0/4.0*state_fab(i + 1, j - 1, k, Idx::gambar01) - 1.0/4.0*state_fab(i - 1, j + 1, k, Idx::gambar01) + (1.0/4.0)*state_fab(i - 1, j - 1, k, Idx::gambar01))/(dx[0]*dx[1]);
         amrex::Real ddgambar0111 = (state_fab(i, j + 1, k, Idx::gambar01) + state_fab(i, j - 1, k, Idx::gambar01) - 2*state_fab(i, j, k, Idx::gambar01))/std::pow(dx[1], 2);
         amrex::Real ddgambar0112 = ((1.0/4.0)*state_fab(i, j + 1, k + 1, Idx::gambar01) - 1.0/4.0*state_fab(i, j + 1, k - 1, Idx::gambar01) - 1.0/4.0*state_fab(i, j - 1, k + 1, Idx::gambar01) + (1.0/4.0)*state_fab(i, j - 1, k - 1, Idx::gambar01))/(dx[1]*dx[2]);
         amrex::Real ddgambar0120 = ((1.0/4.0)*state_fab(i + 1, j, k + 1, Idx::gambar01) - 1.0/4.0*state_fab(i + 1, j, k - 1, Idx::gambar01) - 1.0/4.0*state_fab(i - 1, j, k + 1, Idx::gambar01) + (1.0/4.0)*state_fab(i - 1, j, k - 1, Idx::gambar01))/(dx[0]*dx[2]);
         amrex::Real ddgambar0121 = ((1.0/4.0)*state_fab(i, j + 1, k + 1, Idx::gambar01) - 1.0/4.0*state_fab(i, j + 1, k - 1, Idx::gambar01) - 1.0/4.0*state_fab(i, j - 1, k + 1, Idx::gambar01) + (1.0/4.0)*state_fab(i, j - 1, k - 1, Idx::gambar01))/(dx[1]*dx[2]);
         amrex::Real ddgambar0122 = (state_fab(i, j, k + 1, Idx::gambar01) + state_fab(i, j, k - 1, Idx::gambar01) - 2*state_fab(i, j, k, Idx::gambar01))/std::pow(dx[2], 2);
         amrex::Real ddgambar0200 = (state_fab(i + 1, j, k, Idx::gambar02) + state_fab(i - 1, j, k, Idx::gambar02) - 2*state_fab(i, j, k, Idx::gambar02))/std::pow(dx[0], 2);
         amrex::Real ddgambar0201 = ((1.0/4.0)*state_fab(i + 1, j + 1, k, Idx::gambar02) - 1.0/4.0*state_fab(i + 1, j - 1, k, Idx::gambar02) - 1.0/4.0*state_fab(i - 1, j + 1, k, Idx::gambar02) + (1.0/4.0)*state_fab(i - 1, j - 1, k, Idx::gambar02))/(dx[0]*dx[1]);
         amrex::Real ddgambar0202 = ((1.0/4.0)*state_fab(i + 1, j, k + 1, Idx::gambar02) - 1.0/4.0*state_fab(i + 1, j, k - 1, Idx::gambar02) - 1.0/4.0*state_fab(i - 1, j, k + 1, Idx::gambar02) + (1.0/4.0)*state_fab(i - 1, j, k - 1, Idx::gambar02))/(dx[0]*dx[2]);
         amrex::Real ddgambar0210 = ((1.0/4.0)*state_fab(i + 1, j + 1, k, Idx::gambar02) - 1.0/4.0*state_fab(i + 1, j - 1, k, Idx::gambar02) - 1.0/4.0*state_fab(i - 1, j + 1, k, Idx::gambar02) + (1.0/4.0)*state_fab(i - 1, j - 1, k, Idx::gambar02))/(dx[0]*dx[1]);
         amrex::Real ddgambar0211 = (state_fab(i, j + 1, k, Idx::gambar02) + state_fab(i, j - 1, k, Idx::gambar02) - 2*state_fab(i, j, k, Idx::gambar02))/std::pow(dx[1], 2);
         amrex::Real ddgambar0212 = ((1.0/4.0)*state_fab(i, j + 1, k + 1, Idx::gambar02) - 1.0/4.0*state_fab(i, j + 1, k - 1, Idx::gambar02) - 1.0/4.0*state_fab(i, j - 1, k + 1, Idx::gambar02) + (1.0/4.0)*state_fab(i, j - 1, k - 1, Idx::gambar02))/(dx[1]*dx[2]);
         amrex::Real ddgambar0220 = ((1.0/4.0)*state_fab(i + 1, j, k + 1, Idx::gambar02) - 1.0/4.0*state_fab(i + 1, j, k - 1, Idx::gambar02) - 1.0/4.0*state_fab(i - 1, j, k + 1, Idx::gambar02) + (1.0/4.0)*state_fab(i - 1, j, k - 1, Idx::gambar02))/(dx[0]*dx[2]);
         amrex::Real ddgambar0221 = ((1.0/4.0)*state_fab(i, j + 1, k + 1, Idx::gambar02) - 1.0/4.0*state_fab(i, j + 1, k - 1, Idx::gambar02) - 1.0/4.0*state_fab(i, j - 1, k + 1, Idx::gambar02) + (1.0/4.0)*state_fab(i, j - 1, k - 1, Idx::gambar02))/(dx[1]*dx[2]);
         amrex::Real ddgambar0222 = (state_fab(i, j, k + 1, Idx::gambar02) + state_fab(i, j, k - 1, Idx::gambar02) - 2*state_fab(i, j, k, Idx::gambar02))/std::pow(dx[2], 2);
         amrex::Real ddgambar1000 = (state_fab(i + 1, j, k, Idx::gambar01) + state_fab(i - 1, j, k, Idx::gambar01) - 2*state_fab(i, j, k, Idx::gambar01))/std::pow(dx[0], 2);
         amrex::Real ddgambar1001 = ((1.0/4.0)*state_fab(i + 1, j + 1, k, Idx::gambar01) - 1.0/4.0*state_fab(i + 1, j - 1, k, Idx::gambar01) - 1.0/4.0*state_fab(i - 1, j + 1, k, Idx::gambar01) + (1.0/4.0)*state_fab(i - 1, j - 1, k, Idx::gambar01))/(dx[0]*dx[1]);
         amrex::Real ddgambar1002 = ((1.0/4.0)*state_fab(i + 1, j, k + 1, Idx::gambar01) - 1.0/4.0*state_fab(i + 1, j, k - 1, Idx::gambar01) - 1.0/4.0*state_fab(i - 1, j, k + 1, Idx::gambar01) + (1.0/4.0)*state_fab(i - 1, j, k - 1, Idx::gambar01))/(dx[0]*dx[2]);
         amrex::Real ddgambar1010 = ((1.0/4.0)*state_fab(i + 1, j + 1, k, Idx::gambar01) - 1.0/4.0*state_fab(i + 1, j - 1, k, Idx::gambar01) - 1.0/4.0*state_fab(i - 1, j + 1, k, Idx::gambar01) + (1.0/4.0)*state_fab(i - 1, j - 1, k, Idx::gambar01))/(dx[0]*dx[1]);
         amrex::Real ddgambar1011 = (state_fab(i, j + 1, k, Idx::gambar01) + state_fab(i, j - 1, k, Idx::gambar01) - 2*state_fab(i, j, k, Idx::gambar01))/std::pow(dx[1], 2);
         amrex::Real ddgambar1012 = ((1.0/4.0)*state_fab(i, j + 1, k + 1, Idx::gambar01) - 1.0/4.0*state_fab(i, j + 1, k - 1, Idx::gambar01) - 1.0/4.0*state_fab(i, j - 1, k + 1, Idx::gambar01) + (1.0/4.0)*state_fab(i, j - 1, k - 1, Idx::gambar01))/(dx[1]*dx[2]);
         amrex::Real ddgambar1020 = ((1.0/4.0)*state_fab(i + 1, j, k + 1, Idx::gambar01) - 1.0/4.0*state_fab(i + 1, j, k - 1, Idx::gambar01) - 1.0/4.0*state_fab(i - 1, j, k + 1, Idx::gambar01) + (1.0/4.0)*state_fab(i - 1, j, k - 1, Idx::gambar01))/(dx[0]*dx[2]);
         amrex::Real ddgambar1021 = ((1.0/4.0)*state_fab(i, j + 1, k + 1, Idx::gambar01) - 1.0/4.0*state_fab(i, j + 1, k - 1, Idx::gambar01) - 1.0/4.0*state_fab(i, j - 1, k + 1, Idx::gambar01) + (1.0/4.0)*state_fab(i, j - 1, k - 1, Idx::gambar01))/(dx[1]*dx[2]);
         amrex::Real ddgambar1022 = (state_fab(i, j, k + 1, Idx::gambar01) + state_fab(i, j, k - 1, Idx::gambar01) - 2*state_fab(i, j, k, Idx::gambar01))/std::pow(dx[2], 2);
         amrex::Real ddgambar1100 = (state_fab(i + 1, j, k, Idx::gambar11) + state_fab(i - 1, j, k, Idx::gambar11) - 2*state_fab(i, j, k, Idx::gambar11))/std::pow(dx[0], 2);
         amrex::Real ddgambar1101 = ((1.0/4.0)*state_fab(i + 1, j + 1, k, Idx::gambar11) - 1.0/4.0*state_fab(i + 1, j - 1, k, Idx::gambar11) - 1.0/4.0*state_fab(i - 1, j + 1, k, Idx::gambar11) + (1.0/4.0)*state_fab(i - 1, j - 1, k, Idx::gambar11))/(dx[0]*dx[1]);
         amrex::Real ddgambar1102 = ((1.0/4.0)*state_fab(i + 1, j, k + 1, Idx::gambar11) - 1.0/4.0*state_fab(i + 1, j, k - 1, Idx::gambar11) - 1.0/4.0*state_fab(i - 1, j, k + 1, Idx::gambar11) + (1.0/4.0)*state_fab(i - 1, j, k - 1, Idx::gambar11))/(dx[0]*dx[2]);
         amrex::Real ddgambar1110 = ((1.0/4.0)*state_fab(i + 1, j + 1, k, Idx::gambar11) - 1.0/4.0*state_fab(i + 1, j - 1, k, Idx::gambar11) - 1.0/4.0*state_fab(i - 1, j + 1, k, Idx::gambar11) + (1.0/4.0)*state_fab(i - 1, j - 1, k, Idx::gambar11))/(dx[0]*dx[1]);
         amrex::Real ddgambar1111 = (state_fab(i, j + 1, k, Idx::gambar11) + state_fab(i, j - 1, k, Idx::gambar11) - 2*state_fab(i, j, k, Idx::gambar11))/std::pow(dx[1], 2);
         amrex::Real ddgambar1112 = ((1.0/4.0)*state_fab(i, j + 1, k + 1, Idx::gambar11) - 1.0/4.0*state_fab(i, j + 1, k - 1, Idx::gambar11) - 1.0/4.0*state_fab(i, j - 1, k + 1, Idx::gambar11) + (1.0/4.0)*state_fab(i, j - 1, k - 1, Idx::gambar11))/(dx[1]*dx[2]);
         amrex::Real ddgambar1120 = ((1.0/4.0)*state_fab(i + 1, j, k + 1, Idx::gambar11) - 1.0/4.0*state_fab(i + 1, j, k - 1, Idx::gambar11) - 1.0/4.0*state_fab(i - 1, j, k + 1, Idx::gambar11) + (1.0/4.0)*state_fab(i - 1, j, k - 1, Idx::gambar11))/(dx[0]*dx[2]);
         amrex::Real ddgambar1121 = ((1.0/4.0)*state_fab(i, j + 1, k + 1, Idx::gambar11) - 1.0/4.0*state_fab(i, j + 1, k - 1, Idx::gambar11) - 1.0/4.0*state_fab(i, j - 1, k + 1, Idx::gambar11) + (1.0/4.0)*state_fab(i, j - 1, k - 1, Idx::gambar11))/(dx[1]*dx[2]);
         amrex::Real ddgambar1122 = (state_fab(i, j, k + 1, Idx::gambar11) + state_fab(i, j, k - 1, Idx::gambar11) - 2*state_fab(i, j, k, Idx::gambar11))/std::pow(dx[2], 2);
         amrex::Real ddgambar1200 = (state_fab(i + 1, j, k, Idx::gambar12) + state_fab(i - 1, j, k, Idx::gambar12) - 2*state_fab(i, j, k, Idx::gambar12))/std::pow(dx[0], 2);
         amrex::Real ddgambar1201 = ((1.0/4.0)*state_fab(i + 1, j + 1, k, Idx::gambar12) - 1.0/4.0*state_fab(i + 1, j - 1, k, Idx::gambar12) - 1.0/4.0*state_fab(i - 1, j + 1, k, Idx::gambar12) + (1.0/4.0)*state_fab(i - 1, j - 1, k, Idx::gambar12))/(dx[0]*dx[1]);
         amrex::Real ddgambar1202 = ((1.0/4.0)*state_fab(i + 1, j, k + 1, Idx::gambar12) - 1.0/4.0*state_fab(i + 1, j, k - 1, Idx::gambar12) - 1.0/4.0*state_fab(i - 1, j, k + 1, Idx::gambar12) + (1.0/4.0)*state_fab(i - 1, j, k - 1, Idx::gambar12))/(dx[0]*dx[2]);
         amrex::Real ddgambar1210 = ((1.0/4.0)*state_fab(i + 1, j + 1, k, Idx::gambar12) - 1.0/4.0*state_fab(i + 1, j - 1, k, Idx::gambar12) - 1.0/4.0*state_fab(i - 1, j + 1, k, Idx::gambar12) + (1.0/4.0)*state_fab(i - 1, j - 1, k, Idx::gambar12))/(dx[0]*dx[1]);
         amrex::Real ddgambar1211 = (state_fab(i, j + 1, k, Idx::gambar12) + state_fab(i, j - 1, k, Idx::gambar12) - 2*state_fab(i, j, k, Idx::gambar12))/std::pow(dx[1], 2);
         amrex::Real ddgambar1212 = ((1.0/4.0)*state_fab(i, j + 1, k + 1, Idx::gambar12) - 1.0/4.0*state_fab(i, j + 1, k - 1, Idx::gambar12) - 1.0/4.0*state_fab(i, j - 1, k + 1, Idx::gambar12) + (1.0/4.0)*state_fab(i, j - 1, k - 1, Idx::gambar12))/(dx[1]*dx[2]);
         amrex::Real ddgambar1220 = ((1.0/4.0)*state_fab(i + 1, j, k + 1, Idx::gambar12) - 1.0/4.0*state_fab(i + 1, j, k - 1, Idx::gambar12) - 1.0/4.0*state_fab(i - 1, j, k + 1, Idx::gambar12) + (1.0/4.0)*state_fab(i - 1, j, k - 1, Idx::gambar12))/(dx[0]*dx[2]);
         amrex::Real ddgambar1221 = ((1.0/4.0)*state_fab(i, j + 1, k + 1, Idx::gambar12) - 1.0/4.0*state_fab(i, j + 1, k - 1, Idx::gambar12) - 1.0/4.0*state_fab(i, j - 1, k + 1, Idx::gambar12) + (1.0/4.0)*state_fab(i, j - 1, k - 1, Idx::gambar12))/(dx[1]*dx[2]);
         amrex::Real ddgambar1222 = (state_fab(i, j, k + 1, Idx::gambar12) + state_fab(i, j, k - 1, Idx::gambar12) - 2*state_fab(i, j, k, Idx::gambar12))/std::pow(dx[2], 2);
         amrex::Real ddgambar2000 = (state_fab(i + 1, j, k, Idx::gambar02) + state_fab(i - 1, j, k, Idx::gambar02) - 2*state_fab(i, j, k, Idx::gambar02))/std::pow(dx[0], 2);
         amrex::Real ddgambar2001 = ((1.0/4.0)*state_fab(i + 1, j + 1, k, Idx::gambar02) - 1.0/4.0*state_fab(i + 1, j - 1, k, Idx::gambar02) - 1.0/4.0*state_fab(i - 1, j + 1, k, Idx::gambar02) + (1.0/4.0)*state_fab(i - 1, j - 1, k, Idx::gambar02))/(dx[0]*dx[1]);
         amrex::Real ddgambar2002 = ((1.0/4.0)*state_fab(i + 1, j, k + 1, Idx::gambar02) - 1.0/4.0*state_fab(i + 1, j, k - 1, Idx::gambar02) - 1.0/4.0*state_fab(i - 1, j, k + 1, Idx::gambar02) + (1.0/4.0)*state_fab(i - 1, j, k - 1, Idx::gambar02))/(dx[0]*dx[2]);
         amrex::Real ddgambar2010 = ((1.0/4.0)*state_fab(i + 1, j + 1, k, Idx::gambar02) - 1.0/4.0*state_fab(i + 1, j - 1, k, Idx::gambar02) - 1.0/4.0*state_fab(i - 1, j + 1, k, Idx::gambar02) + (1.0/4.0)*state_fab(i - 1, j - 1, k, Idx::gambar02))/(dx[0]*dx[1]);
         amrex::Real ddgambar2011 = (state_fab(i, j + 1, k, Idx::gambar02) + state_fab(i, j - 1, k, Idx::gambar02) - 2*state_fab(i, j, k, Idx::gambar02))/std::pow(dx[1], 2);
         amrex::Real ddgambar2012 = ((1.0/4.0)*state_fab(i, j + 1, k + 1, Idx::gambar02) - 1.0/4.0*state_fab(i, j + 1, k - 1, Idx::gambar02) - 1.0/4.0*state_fab(i, j - 1, k + 1, Idx::gambar02) + (1.0/4.0)*state_fab(i, j - 1, k - 1, Idx::gambar02))/(dx[1]*dx[2]);
         amrex::Real ddgambar2020 = ((1.0/4.0)*state_fab(i + 1, j, k + 1, Idx::gambar02) - 1.0/4.0*state_fab(i + 1, j, k - 1, Idx::gambar02) - 1.0/4.0*state_fab(i - 1, j, k + 1, Idx::gambar02) + (1.0/4.0)*state_fab(i - 1, j, k - 1, Idx::gambar02))/(dx[0]*dx[2]);
         amrex::Real ddgambar2021 = ((1.0/4.0)*state_fab(i, j + 1, k + 1, Idx::gambar02) - 1.0/4.0*state_fab(i, j + 1, k - 1, Idx::gambar02) - 1.0/4.0*state_fab(i, j - 1, k + 1, Idx::gambar02) + (1.0/4.0)*state_fab(i, j - 1, k - 1, Idx::gambar02))/(dx[1]*dx[2]);
         amrex::Real ddgambar2022 = (state_fab(i, j, k + 1, Idx::gambar02) + state_fab(i, j, k - 1, Idx::gambar02) - 2*state_fab(i, j, k, Idx::gambar02))/std::pow(dx[2], 2);
         amrex::Real ddgambar2100 = (state_fab(i + 1, j, k, Idx::gambar12) + state_fab(i - 1, j, k, Idx::gambar12) - 2*state_fab(i, j, k, Idx::gambar12))/std::pow(dx[0], 2);
         amrex::Real ddgambar2101 = ((1.0/4.0)*state_fab(i + 1, j + 1, k, Idx::gambar12) - 1.0/4.0*state_fab(i + 1, j - 1, k, Idx::gambar12) - 1.0/4.0*state_fab(i - 1, j + 1, k, Idx::gambar12) + (1.0/4.0)*state_fab(i - 1, j - 1, k, Idx::gambar12))/(dx[0]*dx[1]);
         amrex::Real ddgambar2102 = ((1.0/4.0)*state_fab(i + 1, j, k + 1, Idx::gambar12) - 1.0/4.0*state_fab(i + 1, j, k - 1, Idx::gambar12) - 1.0/4.0*state_fab(i - 1, j, k + 1, Idx::gambar12) + (1.0/4.0)*state_fab(i - 1, j, k - 1, Idx::gambar12))/(dx[0]*dx[2]);
         amrex::Real ddgambar2110 = ((1.0/4.0)*state_fab(i + 1, j + 1, k, Idx::gambar12) - 1.0/4.0*state_fab(i + 1, j - 1, k, Idx::gambar12) - 1.0/4.0*state_fab(i - 1, j + 1, k, Idx::gambar12) + (1.0/4.0)*state_fab(i - 1, j - 1, k, Idx::gambar12))/(dx[0]*dx[1]);
         amrex::Real ddgambar2111 = (state_fab(i, j + 1, k, Idx::gambar12) + state_fab(i, j - 1, k, Idx::gambar12) - 2*state_fab(i, j, k, Idx::gambar12))/std::pow(dx[1], 2);
         amrex::Real ddgambar2112 = ((1.0/4.0)*state_fab(i, j + 1, k + 1, Idx::gambar12) - 1.0/4.0*state_fab(i, j + 1, k - 1, Idx::gambar12) - 1.0/4.0*state_fab(i, j - 1, k + 1, Idx::gambar12) + (1.0/4.0)*state_fab(i, j - 1, k - 1, Idx::gambar12))/(dx[1]*dx[2]);
         amrex::Real ddgambar2120 = ((1.0/4.0)*state_fab(i + 1, j, k + 1, Idx::gambar12) - 1.0/4.0*state_fab(i + 1, j, k - 1, Idx::gambar12) - 1.0/4.0*state_fab(i - 1, j, k + 1, Idx::gambar12) + (1.0/4.0)*state_fab(i - 1, j, k - 1, Idx::gambar12))/(dx[0]*dx[2]);
         amrex::Real ddgambar2121 = ((1.0/4.0)*state_fab(i, j + 1, k + 1, Idx::gambar12) - 1.0/4.0*state_fab(i, j + 1, k - 1, Idx::gambar12) - 1.0/4.0*state_fab(i, j - 1, k + 1, Idx::gambar12) + (1.0/4.0)*state_fab(i, j - 1, k - 1, Idx::gambar12))/(dx[1]*dx[2]);
         amrex::Real ddgambar2122 = (state_fab(i, j, k + 1, Idx::gambar12) + state_fab(i, j, k - 1, Idx::gambar12) - 2*state_fab(i, j, k, Idx::gambar12))/std::pow(dx[2], 2);
         amrex::Real ddgambar2200 = (state_fab(i + 1, j, k, Idx::gambar22) + state_fab(i - 1, j, k, Idx::gambar22) - 2*state_fab(i, j, k, Idx::gambar22))/std::pow(dx[0], 2);
         amrex::Real ddgambar2201 = ((1.0/4.0)*state_fab(i + 1, j + 1, k, Idx::gambar22) - 1.0/4.0*state_fab(i + 1, j - 1, k, Idx::gambar22) - 1.0/4.0*state_fab(i - 1, j + 1, k, Idx::gambar22) + (1.0/4.0)*state_fab(i - 1, j - 1, k, Idx::gambar22))/(dx[0]*dx[1]);
         amrex::Real ddgambar2202 = ((1.0/4.0)*state_fab(i + 1, j, k + 1, Idx::gambar22) - 1.0/4.0*state_fab(i + 1, j, k - 1, Idx::gambar22) - 1.0/4.0*state_fab(i - 1, j, k + 1, Idx::gambar22) + (1.0/4.0)*state_fab(i - 1, j, k - 1, Idx::gambar22))/(dx[0]*dx[2]);
         amrex::Real ddgambar2210 = ((1.0/4.0)*state_fab(i + 1, j + 1, k, Idx::gambar22) - 1.0/4.0*state_fab(i + 1, j - 1, k, Idx::gambar22) - 1.0/4.0*state_fab(i - 1, j + 1, k, Idx::gambar22) + (1.0/4.0)*state_fab(i - 1, j - 1, k, Idx::gambar22))/(dx[0]*dx[1]);
         amrex::Real ddgambar2211 = (state_fab(i, j + 1, k, Idx::gambar22) + state_fab(i, j - 1, k, Idx::gambar22) - 2*state_fab(i, j, k, Idx::gambar22))/std::pow(dx[1], 2);
         amrex::Real ddgambar2212 = ((1.0/4.0)*state_fab(i, j + 1, k + 1, Idx::gambar22) - 1.0/4.0*state_fab(i, j + 1, k - 1, Idx::gambar22) - 1.0/4.0*state_fab(i, j - 1, k + 1, Idx::gambar22) + (1.0/4.0)*state_fab(i, j - 1, k - 1, Idx::gambar22))/(dx[1]*dx[2]);
         amrex::Real ddgambar2220 = ((1.0/4.0)*state_fab(i + 1, j, k + 1, Idx::gambar22) - 1.0/4.0*state_fab(i + 1, j, k - 1, Idx::gambar22) - 1.0/4.0*state_fab(i - 1, j, k + 1, Idx::gambar22) + (1.0/4.0)*state_fab(i - 1, j, k - 1, Idx::gambar22))/(dx[0]*dx[2]);
         amrex::Real ddgambar2221 = ((1.0/4.0)*state_fab(i, j + 1, k + 1, Idx::gambar22) - 1.0/4.0*state_fab(i, j + 1, k - 1, Idx::gambar22) - 1.0/4.0*state_fab(i, j - 1, k + 1, Idx::gambar22) + (1.0/4.0)*state_fab(i, j - 1, k - 1, Idx::gambar22))/(dx[1]*dx[2]);
         amrex::Real ddgambar2222 = (state_fab(i, j, k + 1, Idx::gambar22) + state_fab(i, j, k - 1, Idx::gambar22) - 2*state_fab(i, j, k, Idx::gambar22))/std::pow(dx[2], 2);
	 amrex::Real dGambarU00 = ((1.0/2.0)*state_fab(i + 1, j, k, Idx::GambarU0) - 1.0/2.0*state_fab(i - 1, j, k, Idx::GambarU0))/dx[0];
         amrex::Real dGambarU01 = ((1.0/2.0)*state_fab(i, j + 1, k, Idx::GambarU0) - 1.0/2.0*state_fab(i, j - 1, k, Idx::GambarU0))/dx[1];
         amrex::Real dGambarU02 = ((1.0/2.0)*state_fab(i, j, k + 1, Idx::GambarU0) - 1.0/2.0*state_fab(i, j, k - 1, Idx::GambarU0))/dx[2];
         amrex::Real dGambarU10 = ((1.0/2.0)*state_fab(i + 1, j, k, Idx::GambarU1) - 1.0/2.0*state_fab(i - 1, j, k, Idx::GambarU1))/dx[0];
         amrex::Real dGambarU11 = ((1.0/2.0)*state_fab(i, j + 1, k, Idx::GambarU1) - 1.0/2.0*state_fab(i, j - 1, k, Idx::GambarU1))/dx[1];
         amrex::Real dGambarU12 = ((1.0/2.0)*state_fab(i, j, k + 1, Idx::GambarU1) - 1.0/2.0*state_fab(i, j, k - 1, Idx::GambarU1))/dx[2];
         amrex::Real dGambarU20 = ((1.0/2.0)*state_fab(i + 1, j, k, Idx::GambarU2) - 1.0/2.0*state_fab(i - 1, j, k, Idx::GambarU2))/dx[0];
         amrex::Real dGambarU21 = ((1.0/2.0)*state_fab(i, j + 1, k, Idx::GambarU2) - 1.0/2.0*state_fab(i, j - 1, k, Idx::GambarU2))/dx[1];
         amrex::Real dGambarU22 = ((1.0/2.0)*state_fab(i, j, k + 1, Idx::GambarU2) - 1.0/2.0*state_fab(i, j, k - 1, Idx::GambarU2))/dx[2];
	 amrex::Real GambarULL000 = 0.5*dgambar000*gambarinv00 + 0.5*gambarinv01*(-dgambar001 + 2*dgambar100) + 0.5*gambarinv02*(-dgambar002 + 2*dgambar200);
         amrex::Real GambarULL001 = 0.5*dgambar001*gambarinv00 + 0.5*gambarinv01*(-dgambar011 + dgambar101 + dgambar110) + 0.5*gambarinv02*(-dgambar012 + dgambar201 + dgambar210);
         amrex::Real GambarULL002 = 0.5*dgambar002*gambarinv00 + 0.5*gambarinv01*(-dgambar021 + dgambar102 + dgambar120) + 0.5*gambarinv02*(-dgambar022 + dgambar202 + dgambar220);
         amrex::Real GambarULL010 = 0.5*dgambar110*gambarinv01 + 0.5*gambarinv00*(dgambar001 + dgambar010 - dgambar100) + 0.5*gambarinv02*(-dgambar102 + dgambar201 + dgambar210);
         amrex::Real GambarULL011 = 0.5*dgambar111*gambarinv01 + 0.5*gambarinv00*(2*dgambar011 - dgambar110) + 0.5*gambarinv02*(-dgambar112 + 2*dgambar211);
         amrex::Real GambarULL012 = 0.5*dgambar112*gambarinv01 + 0.5*gambarinv00*(dgambar012 + dgambar021 - dgambar120) + 0.5*gambarinv02*(-dgambar122 + dgambar212 + dgambar221);
         amrex::Real GambarULL020 = 0.5*dgambar220*gambarinv02 + 0.5*gambarinv00*(dgambar002 + dgambar020 - dgambar200) + 0.5*gambarinv01*(dgambar102 + dgambar120 - dgambar201);
         amrex::Real GambarULL021 = 0.5*dgambar221*gambarinv02 + 0.5*gambarinv00*(dgambar012 + dgambar021 - dgambar210) + 0.5*gambarinv01*(dgambar112 + dgambar121 - dgambar211);
         amrex::Real GambarULL022 = 0.5*dgambar222*gambarinv02 + 0.5*gambarinv00*(2*dgambar022 - dgambar220) + 0.5*gambarinv01*(2*dgambar122 - dgambar221);
         amrex::Real GambarULL100 = 0.5*dgambar000*gambarinv10 + 0.5*gambarinv11*(-dgambar001 + 2*dgambar100) + 0.5*gambarinv12*(-dgambar002 + 2*dgambar200);
         amrex::Real GambarULL101 = 0.5*dgambar001*gambarinv10 + 0.5*gambarinv11*(-dgambar011 + dgambar101 + dgambar110) + 0.5*gambarinv12*(-dgambar012 + dgambar201 + dgambar210);
         amrex::Real GambarULL102 = 0.5*dgambar002*gambarinv10 + 0.5*gambarinv11*(-dgambar021 + dgambar102 + dgambar120) + 0.5*gambarinv12*(-dgambar022 + dgambar202 + dgambar220);
         amrex::Real GambarULL110 = 0.5*dgambar110*gambarinv11 + 0.5*gambarinv10*(dgambar001 + dgambar010 - dgambar100) + 0.5*gambarinv12*(-dgambar102 + dgambar201 + dgambar210);
         amrex::Real GambarULL111 = 0.5*dgambar111*gambarinv11 + 0.5*gambarinv10*(2*dgambar011 - dgambar110) + 0.5*gambarinv12*(-dgambar112 + 2*dgambar211);
         amrex::Real GambarULL112 = 0.5*dgambar112*gambarinv11 + 0.5*gambarinv10*(dgambar012 + dgambar021 - dgambar120) + 0.5*gambarinv12*(-dgambar122 + dgambar212 + dgambar221);
         amrex::Real GambarULL120 = 0.5*dgambar220*gambarinv12 + 0.5*gambarinv10*(dgambar002 + dgambar020 - dgambar200) + 0.5*gambarinv11*(dgambar102 + dgambar120 - dgambar201);
         amrex::Real GambarULL121 = 0.5*dgambar221*gambarinv12 + 0.5*gambarinv10*(dgambar012 + dgambar021 - dgambar210) + 0.5*gambarinv11*(dgambar112 + dgambar121 - dgambar211);
         amrex::Real GambarULL122 = 0.5*dgambar222*gambarinv12 + 0.5*gambarinv10*(2*dgambar022 - dgambar220) + 0.5*gambarinv11*(2*dgambar122 - dgambar221);
         amrex::Real GambarULL200 = 0.5*dgambar000*gambarinv20 + 0.5*gambarinv21*(-dgambar001 + 2*dgambar100) + 0.5*gambarinv22*(-dgambar002 + 2*dgambar200);
         amrex::Real GambarULL201 = 0.5*dgambar001*gambarinv20 + 0.5*gambarinv21*(-dgambar011 + dgambar101 + dgambar110) + 0.5*gambarinv22*(-dgambar012 + dgambar201 + dgambar210);
         amrex::Real GambarULL202 = 0.5*dgambar002*gambarinv20 + 0.5*gambarinv21*(-dgambar021 + dgambar102 + dgambar120) + 0.5*gambarinv22*(-dgambar022 + dgambar202 + dgambar220);
         amrex::Real GambarULL210 = 0.5*dgambar110*gambarinv21 + 0.5*gambarinv20*(dgambar001 + dgambar010 - dgambar100) + 0.5*gambarinv22*(-dgambar102 + dgambar201 + dgambar210);
         amrex::Real GambarULL211 = 0.5*dgambar111*gambarinv21 + 0.5*gambarinv20*(2*dgambar011 - dgambar110) + 0.5*gambarinv22*(-dgambar112 + 2*dgambar211);
         amrex::Real GambarULL212 = 0.5*dgambar112*gambarinv21 + 0.5*gambarinv20*(dgambar012 + dgambar021 - dgambar120) + 0.5*gambarinv22*(-dgambar122 + dgambar212 + dgambar221);
         amrex::Real GambarULL220 = 0.5*dgambar220*gambarinv22 + 0.5*gambarinv20*(dgambar002 + dgambar020 - dgambar200) + 0.5*gambarinv21*(dgambar102 + dgambar120 - dgambar201);
         amrex::Real GambarULL221 = 0.5*dgambar221*gambarinv22 + 0.5*gambarinv20*(dgambar012 + dgambar021 - dgambar210) + 0.5*gambarinv21*(dgambar112 + dgambar121 - dgambar211);
         amrex::Real GambarULL222 = 0.5*dgambar222*gambarinv22 + 0.5*gambarinv20*(2*dgambar022 - dgambar220) + 0.5*gambarinv21*(2*dgambar122 - dgambar221);
         amrex::Real GambarLLL000 = gambar00*(0.5*dgambar000*gambarinv00 + 0.5*gambarinv01*(-dgambar001 + 2*dgambar100) + 0.5*gambarinv02*(-dgambar002 + 2*dgambar200)) + gambar01*(0.5*dgambar000*gambarinv10 + 0.5*gambarinv11*(-dgambar001 + 2*dgambar100) + 0.5*gambarinv12*(-dgambar002 + 2*dgambar200)) + gambar02*(0.5*dgambar000*gambarinv20 + 0.5*gambarinv21*(-dgambar001 + 2*dgambar100) + 0.5*gambarinv22*(-dgambar002 + 2*dgambar200));
         amrex::Real GambarLLL001 = gambar00*(0.5*dgambar001*gambarinv00 + 0.5*gambarinv01*(-dgambar011 + dgambar101 + dgambar110) + 0.5*gambarinv02*(-dgambar012 + dgambar201 + dgambar210)) + gambar01*(0.5*dgambar001*gambarinv10 + 0.5*gambarinv11*(-dgambar011 + dgambar101 + dgambar110) + 0.5*gambarinv12*(-dgambar012 + dgambar201 + dgambar210)) + gambar02*(0.5*dgambar001*gambarinv20 + 0.5*gambarinv21*(-dgambar011 + dgambar101 + dgambar110) + 0.5*gambarinv22*(-dgambar012 + dgambar201 + dgambar210));
         amrex::Real GambarLLL002 = gambar00*(0.5*dgambar002*gambarinv00 + 0.5*gambarinv01*(-dgambar021 + dgambar102 + dgambar120) + 0.5*gambarinv02*(-dgambar022 + dgambar202 + dgambar220)) + gambar01*(0.5*dgambar002*gambarinv10 + 0.5*gambarinv11*(-dgambar021 + dgambar102 + dgambar120) + 0.5*gambarinv12*(-dgambar022 + dgambar202 + dgambar220)) + gambar02*(0.5*dgambar002*gambarinv20 + 0.5*gambarinv21*(-dgambar021 + dgambar102 + dgambar120) + 0.5*gambarinv22*(-dgambar022 + dgambar202 + dgambar220));
         amrex::Real GambarLLL010 = gambar00*(0.5*dgambar110*gambarinv01 + 0.5*gambarinv00*(dgambar001 + dgambar010 - dgambar100) + 0.5*gambarinv02*(-dgambar102 + dgambar201 + dgambar210)) + gambar01*(0.5*dgambar110*gambarinv11 + 0.5*gambarinv10*(dgambar001 + dgambar010 - dgambar100) + 0.5*gambarinv12*(-dgambar102 + dgambar201 + dgambar210)) + gambar02*(0.5*dgambar110*gambarinv21 + 0.5*gambarinv20*(dgambar001 + dgambar010 - dgambar100) + 0.5*gambarinv22*(-dgambar102 + dgambar201 + dgambar210));
         amrex::Real GambarLLL011 = gambar00*(0.5*dgambar111*gambarinv01 + 0.5*gambarinv00*(2*dgambar011 - dgambar110) + 0.5*gambarinv02*(-dgambar112 + 2*dgambar211)) + gambar01*(0.5*dgambar111*gambarinv11 + 0.5*gambarinv10*(2*dgambar011 - dgambar110) + 0.5*gambarinv12*(-dgambar112 + 2*dgambar211)) + gambar02*(0.5*dgambar111*gambarinv21 + 0.5*gambarinv20*(2*dgambar011 - dgambar110) + 0.5*gambarinv22*(-dgambar112 + 2*dgambar211));
         amrex::Real GambarLLL012 = gambar00*(0.5*dgambar112*gambarinv01 + 0.5*gambarinv00*(dgambar012 + dgambar021 - dgambar120) + 0.5*gambarinv02*(-dgambar122 + dgambar212 + dgambar221)) + gambar01*(0.5*dgambar112*gambarinv11 + 0.5*gambarinv10*(dgambar012 + dgambar021 - dgambar120) + 0.5*gambarinv12*(-dgambar122 + dgambar212 + dgambar221)) + gambar02*(0.5*dgambar112*gambarinv21 + 0.5*gambarinv20*(dgambar012 + dgambar021 - dgambar120) + 0.5*gambarinv22*(-dgambar122 + dgambar212 + dgambar221));
         amrex::Real GambarLLL020 = gambar00*(0.5*dgambar220*gambarinv02 + 0.5*gambarinv00*(dgambar002 + dgambar020 - dgambar200) + 0.5*gambarinv01*(dgambar102 + dgambar120 - dgambar201)) + gambar01*(0.5*dgambar220*gambarinv12 + 0.5*gambarinv10*(dgambar002 + dgambar020 - dgambar200) + 0.5*gambarinv11*(dgambar102 + dgambar120 - dgambar201)) + gambar02*(0.5*dgambar220*gambarinv22 + 0.5*gambarinv20*(dgambar002 + dgambar020 - dgambar200) + 0.5*gambarinv21*(dgambar102 + dgambar120 - dgambar201));
         amrex::Real GambarLLL021 = gambar00*(0.5*dgambar221*gambarinv02 + 0.5*gambarinv00*(dgambar012 + dgambar021 - dgambar210) + 0.5*gambarinv01*(dgambar112 + dgambar121 - dgambar211)) + gambar01*(0.5*dgambar221*gambarinv12 + 0.5*gambarinv10*(dgambar012 + dgambar021 - dgambar210) + 0.5*gambarinv11*(dgambar112 + dgambar121 - dgambar211)) + gambar02*(0.5*dgambar221*gambarinv22 + 0.5*gambarinv20*(dgambar012 + dgambar021 - dgambar210) + 0.5*gambarinv21*(dgambar112 + dgambar121 - dgambar211));
         amrex::Real GambarLLL022 = gambar00*(0.5*dgambar222*gambarinv02 + 0.5*gambarinv00*(2*dgambar022 - dgambar220) + 0.5*gambarinv01*(2*dgambar122 - dgambar221)) + gambar01*(0.5*dgambar222*gambarinv12 + 0.5*gambarinv10*(2*dgambar022 - dgambar220) + 0.5*gambarinv11*(2*dgambar122 - dgambar221)) + gambar02*(0.5*dgambar222*gambarinv22 + 0.5*gambarinv20*(2*dgambar022 - dgambar220) + 0.5*gambarinv21*(2*dgambar122 - dgambar221));
         amrex::Real GambarLLL100 = gambar10*(0.5*dgambar000*gambarinv00 + 0.5*gambarinv01*(-dgambar001 + 2*dgambar100) + 0.5*gambarinv02*(-dgambar002 + 2*dgambar200)) + gambar11*(0.5*dgambar000*gambarinv10 + 0.5*gambarinv11*(-dgambar001 + 2*dgambar100) + 0.5*gambarinv12*(-dgambar002 + 2*dgambar200)) + gambar12*(0.5*dgambar000*gambarinv20 + 0.5*gambarinv21*(-dgambar001 + 2*dgambar100) + 0.5*gambarinv22*(-dgambar002 + 2*dgambar200));
         amrex::Real GambarLLL101 = gambar10*(0.5*dgambar001*gambarinv00 + 0.5*gambarinv01*(-dgambar011 + dgambar101 + dgambar110) + 0.5*gambarinv02*(-dgambar012 + dgambar201 + dgambar210)) + gambar11*(0.5*dgambar001*gambarinv10 + 0.5*gambarinv11*(-dgambar011 + dgambar101 + dgambar110) + 0.5*gambarinv12*(-dgambar012 + dgambar201 + dgambar210)) + gambar12*(0.5*dgambar001*gambarinv20 + 0.5*gambarinv21*(-dgambar011 + dgambar101 + dgambar110) + 0.5*gambarinv22*(-dgambar012 + dgambar201 + dgambar210));
         amrex::Real GambarLLL102 = gambar10*(0.5*dgambar002*gambarinv00 + 0.5*gambarinv01*(-dgambar021 + dgambar102 + dgambar120) + 0.5*gambarinv02*(-dgambar022 + dgambar202 + dgambar220)) + gambar11*(0.5*dgambar002*gambarinv10 + 0.5*gambarinv11*(-dgambar021 + dgambar102 + dgambar120) + 0.5*gambarinv12*(-dgambar022 + dgambar202 + dgambar220)) + gambar12*(0.5*dgambar002*gambarinv20 + 0.5*gambarinv21*(-dgambar021 + dgambar102 + dgambar120) + 0.5*gambarinv22*(-dgambar022 + dgambar202 + dgambar220));
         amrex::Real GambarLLL110 = gambar10*(0.5*dgambar110*gambarinv01 + 0.5*gambarinv00*(dgambar001 + dgambar010 - dgambar100) + 0.5*gambarinv02*(-dgambar102 + dgambar201 + dgambar210)) + gambar11*(0.5*dgambar110*gambarinv11 + 0.5*gambarinv10*(dgambar001 + dgambar010 - dgambar100) + 0.5*gambarinv12*(-dgambar102 + dgambar201 + dgambar210)) + gambar12*(0.5*dgambar110*gambarinv21 + 0.5*gambarinv20*(dgambar001 + dgambar010 - dgambar100) + 0.5*gambarinv22*(-dgambar102 + dgambar201 + dgambar210));
         amrex::Real GambarLLL111 = gambar10*(0.5*dgambar111*gambarinv01 + 0.5*gambarinv00*(2*dgambar011 - dgambar110) + 0.5*gambarinv02*(-dgambar112 + 2*dgambar211)) + gambar11*(0.5*dgambar111*gambarinv11 + 0.5*gambarinv10*(2*dgambar011 - dgambar110) + 0.5*gambarinv12*(-dgambar112 + 2*dgambar211)) + gambar12*(0.5*dgambar111*gambarinv21 + 0.5*gambarinv20*(2*dgambar011 - dgambar110) + 0.5*gambarinv22*(-dgambar112 + 2*dgambar211));
         amrex::Real GambarLLL112 = gambar10*(0.5*dgambar112*gambarinv01 + 0.5*gambarinv00*(dgambar012 + dgambar021 - dgambar120) + 0.5*gambarinv02*(-dgambar122 + dgambar212 + dgambar221)) + gambar11*(0.5*dgambar112*gambarinv11 + 0.5*gambarinv10*(dgambar012 + dgambar021 - dgambar120) + 0.5*gambarinv12*(-dgambar122 + dgambar212 + dgambar221)) + gambar12*(0.5*dgambar112*gambarinv21 + 0.5*gambarinv20*(dgambar012 + dgambar021 - dgambar120) + 0.5*gambarinv22*(-dgambar122 + dgambar212 + dgambar221));
         amrex::Real GambarLLL120 = gambar10*(0.5*dgambar220*gambarinv02 + 0.5*gambarinv00*(dgambar002 + dgambar020 - dgambar200) + 0.5*gambarinv01*(dgambar102 + dgambar120 - dgambar201)) + gambar11*(0.5*dgambar220*gambarinv12 + 0.5*gambarinv10*(dgambar002 + dgambar020 - dgambar200) + 0.5*gambarinv11*(dgambar102 + dgambar120 - dgambar201)) + gambar12*(0.5*dgambar220*gambarinv22 + 0.5*gambarinv20*(dgambar002 + dgambar020 - dgambar200) + 0.5*gambarinv21*(dgambar102 + dgambar120 - dgambar201));
         amrex::Real GambarLLL121 = gambar10*(0.5*dgambar221*gambarinv02 + 0.5*gambarinv00*(dgambar012 + dgambar021 - dgambar210) + 0.5*gambarinv01*(dgambar112 + dgambar121 - dgambar211)) + gambar11*(0.5*dgambar221*gambarinv12 + 0.5*gambarinv10*(dgambar012 + dgambar021 - dgambar210) + 0.5*gambarinv11*(dgambar112 + dgambar121 - dgambar211)) + gambar12*(0.5*dgambar221*gambarinv22 + 0.5*gambarinv20*(dgambar012 + dgambar021 - dgambar210) + 0.5*gambarinv21*(dgambar112 + dgambar121 - dgambar211));
         amrex::Real GambarLLL122 = gambar10*(0.5*dgambar222*gambarinv02 + 0.5*gambarinv00*(2*dgambar022 - dgambar220) + 0.5*gambarinv01*(2*dgambar122 - dgambar221)) + gambar11*(0.5*dgambar222*gambarinv12 + 0.5*gambarinv10*(2*dgambar022 - dgambar220) + 0.5*gambarinv11*(2*dgambar122 - dgambar221)) + gambar12*(0.5*dgambar222*gambarinv22 + 0.5*gambarinv20*(2*dgambar022 - dgambar220) + 0.5*gambarinv21*(2*dgambar122 - dgambar221));
         amrex::Real GambarLLL200 = gambar20*(0.5*dgambar000*gambarinv00 + 0.5*gambarinv01*(-dgambar001 + 2*dgambar100) + 0.5*gambarinv02*(-dgambar002 + 2*dgambar200)) + gambar21*(0.5*dgambar000*gambarinv10 + 0.5*gambarinv11*(-dgambar001 + 2*dgambar100) + 0.5*gambarinv12*(-dgambar002 + 2*dgambar200)) + gambar22*(0.5*dgambar000*gambarinv20 + 0.5*gambarinv21*(-dgambar001 + 2*dgambar100) + 0.5*gambarinv22*(-dgambar002 + 2*dgambar200));
         amrex::Real GambarLLL201 = gambar20*(0.5*dgambar001*gambarinv00 + 0.5*gambarinv01*(-dgambar011 + dgambar101 + dgambar110) + 0.5*gambarinv02*(-dgambar012 + dgambar201 + dgambar210)) + gambar21*(0.5*dgambar001*gambarinv10 + 0.5*gambarinv11*(-dgambar011 + dgambar101 + dgambar110) + 0.5*gambarinv12*(-dgambar012 + dgambar201 + dgambar210)) + gambar22*(0.5*dgambar001*gambarinv20 + 0.5*gambarinv21*(-dgambar011 + dgambar101 + dgambar110) + 0.5*gambarinv22*(-dgambar012 + dgambar201 + dgambar210));
         amrex::Real GambarLLL202 = gambar20*(0.5*dgambar002*gambarinv00 + 0.5*gambarinv01*(-dgambar021 + dgambar102 + dgambar120) + 0.5*gambarinv02*(-dgambar022 + dgambar202 + dgambar220)) + gambar21*(0.5*dgambar002*gambarinv10 + 0.5*gambarinv11*(-dgambar021 + dgambar102 + dgambar120) + 0.5*gambarinv12*(-dgambar022 + dgambar202 + dgambar220)) + gambar22*(0.5*dgambar002*gambarinv20 + 0.5*gambarinv21*(-dgambar021 + dgambar102 + dgambar120) + 0.5*gambarinv22*(-dgambar022 + dgambar202 + dgambar220));
         amrex::Real GambarLLL210 = gambar20*(0.5*dgambar110*gambarinv01 + 0.5*gambarinv00*(dgambar001 + dgambar010 - dgambar100) + 0.5*gambarinv02*(-dgambar102 + dgambar201 + dgambar210)) + gambar21*(0.5*dgambar110*gambarinv11 + 0.5*gambarinv10*(dgambar001 + dgambar010 - dgambar100) + 0.5*gambarinv12*(-dgambar102 + dgambar201 + dgambar210)) + gambar22*(0.5*dgambar110*gambarinv21 + 0.5*gambarinv20*(dgambar001 + dgambar010 - dgambar100) + 0.5*gambarinv22*(-dgambar102 + dgambar201 + dgambar210));
         amrex::Real GambarLLL211 = gambar20*(0.5*dgambar111*gambarinv01 + 0.5*gambarinv00*(2*dgambar011 - dgambar110) + 0.5*gambarinv02*(-dgambar112 + 2*dgambar211)) + gambar21*(0.5*dgambar111*gambarinv11 + 0.5*gambarinv10*(2*dgambar011 - dgambar110) + 0.5*gambarinv12*(-dgambar112 + 2*dgambar211)) + gambar22*(0.5*dgambar111*gambarinv21 + 0.5*gambarinv20*(2*dgambar011 - dgambar110) + 0.5*gambarinv22*(-dgambar112 + 2*dgambar211));
         amrex::Real GambarLLL212 = gambar20*(0.5*dgambar112*gambarinv01 + 0.5*gambarinv00*(dgambar012 + dgambar021 - dgambar120) + 0.5*gambarinv02*(-dgambar122 + dgambar212 + dgambar221)) + gambar21*(0.5*dgambar112*gambarinv11 + 0.5*gambarinv10*(dgambar012 + dgambar021 - dgambar120) + 0.5*gambarinv12*(-dgambar122 + dgambar212 + dgambar221)) + gambar22*(0.5*dgambar112*gambarinv21 + 0.5*gambarinv20*(dgambar012 + dgambar021 - dgambar120) + 0.5*gambarinv22*(-dgambar122 + dgambar212 + dgambar221));
         amrex::Real GambarLLL220 = gambar20*(0.5*dgambar220*gambarinv02 + 0.5*gambarinv00*(dgambar002 + dgambar020 - dgambar200) + 0.5*gambarinv01*(dgambar102 + dgambar120 - dgambar201)) + gambar21*(0.5*dgambar220*gambarinv12 + 0.5*gambarinv10*(dgambar002 + dgambar020 - dgambar200) + 0.5*gambarinv11*(dgambar102 + dgambar120 - dgambar201)) + gambar22*(0.5*dgambar220*gambarinv22 + 0.5*gambarinv20*(dgambar002 + dgambar020 - dgambar200) + 0.5*gambarinv21*(dgambar102 + dgambar120 - dgambar201));
         amrex::Real GambarLLL221 = gambar20*(0.5*dgambar221*gambarinv02 + 0.5*gambarinv00*(dgambar012 + dgambar021 - dgambar210) + 0.5*gambarinv01*(dgambar112 + dgambar121 - dgambar211)) + gambar21*(0.5*dgambar221*gambarinv12 + 0.5*gambarinv10*(dgambar012 + dgambar021 - dgambar210) + 0.5*gambarinv11*(dgambar112 + dgambar121 - dgambar211)) + gambar22*(0.5*dgambar221*gambarinv22 + 0.5*gambarinv20*(dgambar012 + dgambar021 - dgambar210) + 0.5*gambarinv21*(dgambar112 + dgambar121 - dgambar211));
         amrex::Real GambarLLL222 = gambar20*(0.5*dgambar222*gambarinv02 + 0.5*gambarinv00*(2*dgambar022 - dgambar220) + 0.5*gambarinv01*(2*dgambar122 - dgambar221)) + gambar21*(0.5*dgambar222*gambarinv12 + 0.5*gambarinv10*(2*dgambar022 - dgambar220) + 0.5*gambarinv11*(2*dgambar122 - dgambar221)) + gambar22*(0.5*dgambar222*gambarinv22 + 0.5*gambarinv20*(2*dgambar022 - dgambar220) + 0.5*gambarinv21*(2*dgambar122 - dgambar221));
	 amrex::Real AbarUU00 = Abar00*std::pow(gambarinv00, 2) + Abar01*gambarinv00*gambarinv01 + Abar02*gambarinv00*gambarinv02 + Abar10*gambarinv00*gambarinv01 + Abar11*std::pow(gambarinv01, 2) + Abar12*gambarinv01*gambarinv02 + Abar20*gambarinv00*gambarinv02 + Abar21*gambarinv01*gambarinv02 + Abar22*std::pow(gambarinv02, 2);
         amrex::Real AbarUU01 = Abar00*gambarinv00*gambarinv10 + Abar01*gambarinv00*gambarinv11 + Abar02*gambarinv00*gambarinv12 + Abar10*gambarinv01*gambarinv10 + Abar11*gambarinv01*gambarinv11 + Abar12*gambarinv01*gambarinv12 + Abar20*gambarinv02*gambarinv10 + Abar21*gambarinv02*gambarinv11 + Abar22*gambarinv02*gambarinv12;
         amrex::Real AbarUU02 = Abar00*gambarinv00*gambarinv20 + Abar01*gambarinv00*gambarinv21 + Abar02*gambarinv00*gambarinv22 + Abar10*gambarinv01*gambarinv20 + Abar11*gambarinv01*gambarinv21 + Abar12*gambarinv01*gambarinv22 + Abar20*gambarinv02*gambarinv20 + Abar21*gambarinv02*gambarinv21 + Abar22*gambarinv02*gambarinv22;
         amrex::Real AbarUU10 = Abar00*gambarinv00*gambarinv10 + Abar01*gambarinv01*gambarinv10 + Abar02*gambarinv02*gambarinv10 + Abar10*gambarinv00*gambarinv11 + Abar11*gambarinv01*gambarinv11 + Abar12*gambarinv02*gambarinv11 + Abar20*gambarinv00*gambarinv12 + Abar21*gambarinv01*gambarinv12 + Abar22*gambarinv02*gambarinv12;
         amrex::Real AbarUU11 = Abar00*std::pow(gambarinv10, 2) + Abar01*gambarinv10*gambarinv11 + Abar02*gambarinv10*gambarinv12 + Abar10*gambarinv10*gambarinv11 + Abar11*std::pow(gambarinv11, 2) + Abar12*gambarinv11*gambarinv12 + Abar20*gambarinv10*gambarinv12 + Abar21*gambarinv11*gambarinv12 + Abar22*std::pow(gambarinv12, 2);
         amrex::Real AbarUU12 = Abar00*gambarinv10*gambarinv20 + Abar01*gambarinv10*gambarinv21 + Abar02*gambarinv10*gambarinv22 + Abar10*gambarinv11*gambarinv20 + Abar11*gambarinv11*gambarinv21 + Abar12*gambarinv11*gambarinv22 + Abar20*gambarinv12*gambarinv20 + Abar21*gambarinv12*gambarinv21 + Abar22*gambarinv12*gambarinv22;
         amrex::Real AbarUU20 = Abar00*gambarinv00*gambarinv20 + Abar01*gambarinv01*gambarinv20 + Abar02*gambarinv02*gambarinv20 + Abar10*gambarinv00*gambarinv21 + Abar11*gambarinv01*gambarinv21 + Abar12*gambarinv02*gambarinv21 + Abar20*gambarinv00*gambarinv22 + Abar21*gambarinv01*gambarinv22 + Abar22*gambarinv02*gambarinv22;
         amrex::Real AbarUU21 = Abar00*gambarinv10*gambarinv20 + Abar01*gambarinv11*gambarinv20 + Abar02*gambarinv12*gambarinv20 + Abar10*gambarinv10*gambarinv21 + Abar11*gambarinv11*gambarinv21 + Abar12*gambarinv12*gambarinv21 + Abar20*gambarinv10*gambarinv22 + Abar21*gambarinv11*gambarinv22 + Abar22*gambarinv12*gambarinv22;
         amrex::Real AbarUU22 = Abar00*std::pow(gambarinv20, 2) + Abar01*gambarinv20*gambarinv21 + Abar02*gambarinv20*gambarinv22 + Abar10*gambarinv20*gambarinv21 + Abar11*std::pow(gambarinv21, 2) + Abar12*gambarinv21*gambarinv22 + Abar20*gambarinv20*gambarinv22 + Abar21*gambarinv21*gambarinv22 + Abar22*std::pow(gambarinv22, 2);
	 amrex::Real RbarLL00 = 1.0*GambarLLL000*GambarU0 + 3*GambarLLL000*GambarULL000*gambarinv00 + GambarLLL000*GambarULL001*gambarinv01 + GambarLLL000*GambarULL002*gambarinv02 + 2*GambarLLL000*GambarULL010*gambarinv10 + 2*GambarLLL000*GambarULL020*gambarinv20 + 1.0*GambarLLL001*GambarU1 + 2*GambarLLL001*GambarULL000*gambarinv01 + 2*GambarLLL001*GambarULL010*gambarinv11 + 2*GambarLLL001*GambarULL020*gambarinv21 + 1.0*GambarLLL002*GambarU2 + 2*GambarLLL002*GambarULL000*gambarinv02 + 2*GambarLLL002*GambarULL010*gambarinv12 + 2*GambarLLL002*GambarULL020*gambarinv22 + GambarLLL010*GambarULL000*gambarinv10 + GambarLLL010*GambarULL001*gambarinv11 + GambarLLL010*GambarULL002*gambarinv12 + 2*GambarLLL010*GambarULL100*gambarinv00 + 2*GambarLLL010*GambarULL110*gambarinv10 + 2*GambarLLL010*GambarULL120*gambarinv20 + 2*GambarLLL011*GambarULL100*gambarinv01 + 2*GambarLLL011*GambarULL110*gambarinv11 + 2*GambarLLL011*GambarULL120*gambarinv21 + 2*GambarLLL012*GambarULL100*gambarinv02 + 2*GambarLLL012*GambarULL110*gambarinv12 + 2*GambarLLL012*GambarULL120*gambarinv22 + GambarLLL020*GambarULL000*gambarinv20 + GambarLLL020*GambarULL001*gambarinv21 + GambarLLL020*GambarULL002*gambarinv22 + 2*GambarLLL020*GambarULL200*gambarinv00 + 2*GambarLLL020*GambarULL210*gambarinv10 + 2*GambarLLL020*GambarULL220*gambarinv20 + 2*GambarLLL021*GambarULL200*gambarinv01 + 2*GambarLLL021*GambarULL210*gambarinv11 + 2*GambarLLL021*GambarULL220*gambarinv21 + 2*GambarLLL022*GambarULL200*gambarinv02 + 2*GambarLLL022*GambarULL210*gambarinv12 + 2*GambarLLL022*GambarULL220*gambarinv22 + GambarLLL100*GambarULL100*gambarinv00 + GambarLLL100*GambarULL101*gambarinv01 + GambarLLL100*GambarULL102*gambarinv02 + GambarLLL110*GambarULL100*gambarinv10 + GambarLLL110*GambarULL101*gambarinv11 + GambarLLL110*GambarULL102*gambarinv12 + GambarLLL120*GambarULL100*gambarinv20 + GambarLLL120*GambarULL101*gambarinv21 + GambarLLL120*GambarULL102*gambarinv22 + GambarLLL200*GambarULL200*gambarinv00 + GambarLLL200*GambarULL201*gambarinv01 + GambarLLL200*GambarULL202*gambarinv02 + GambarLLL210*GambarULL200*gambarinv10 + GambarLLL210*GambarULL201*gambarinv11 + GambarLLL210*GambarULL202*gambarinv12 + GambarLLL220*GambarULL200*gambarinv20 + GambarLLL220*GambarULL201*gambarinv21 + GambarLLL220*GambarULL202*gambarinv22 + 1.0*dGambarU00*gambar00 + 1.0*dGambarU10*gambar10 + 1.0*dGambarU20*gambar20 - 0.5*ddgambar0000*gambarinv00 - 0.5*ddgambar0001*gambarinv01 - 0.5*ddgambar0002*gambarinv02 - 0.5*ddgambar0010*gambarinv10 - 0.5*ddgambar0011*gambarinv11 - 0.5*ddgambar0012*gambarinv12 - 0.5*ddgambar0020*gambarinv20 - 0.5*ddgambar0021*gambarinv21 - 0.5*ddgambar0022*gambarinv22;
         amrex::Real RbarLL01 = GambarLLL001*GambarULL000*gambarinv00 + GambarLLL001*GambarULL001*gambarinv01 + GambarLLL001*GambarULL002*gambarinv02 + GambarLLL011*GambarULL000*gambarinv10 + GambarLLL011*GambarULL001*gambarinv11 + GambarLLL011*GambarULL002*gambarinv12 + GambarLLL021*GambarULL000*gambarinv20 + GambarLLL021*GambarULL001*gambarinv21 + GambarLLL021*GambarULL002*gambarinv22 + GambarLLL101*GambarULL100*gambarinv00 + GambarLLL101*GambarULL101*gambarinv01 + GambarLLL101*GambarULL102*gambarinv02 + GambarLLL111*GambarULL100*gambarinv10 + GambarLLL111*GambarULL101*gambarinv11 + GambarLLL111*GambarULL102*gambarinv12 + GambarLLL121*GambarULL100*gambarinv20 + GambarLLL121*GambarULL101*gambarinv21 + GambarLLL121*GambarULL102*gambarinv22 + GambarLLL201*GambarULL200*gambarinv00 + GambarLLL201*GambarULL201*gambarinv01 + GambarLLL201*GambarULL202*gambarinv02 + GambarLLL211*GambarULL200*gambarinv10 + GambarLLL211*GambarULL201*gambarinv11 + GambarLLL211*GambarULL202*gambarinv12 + GambarLLL221*GambarULL200*gambarinv20 + GambarLLL221*GambarULL201*gambarinv21 + GambarLLL221*GambarULL202*gambarinv22 + 0.5*GambarU0*(GambarLLL010 + GambarLLL100) + 0.5*GambarU1*(GambarLLL011 + GambarLLL101) + 0.5*GambarU2*(GambarLLL012 + GambarLLL102) + 0.5*dGambarU00*gambar01 + 0.5*dGambarU01*gambar00 + 0.5*dGambarU10*gambar11 + 0.5*dGambarU11*gambar10 + 0.5*dGambarU20*gambar21 + 0.5*dGambarU21*gambar20 - 0.5*ddgambar0100*gambarinv00 - 0.5*ddgambar0101*gambarinv01 - 0.5*ddgambar0102*gambarinv02 - 0.5*ddgambar0110*gambarinv10 - 0.5*ddgambar0111*gambarinv11 - 0.5*ddgambar0112*gambarinv12 - 0.5*ddgambar0120*gambarinv20 - 0.5*ddgambar0121*gambarinv21 - 0.5*ddgambar0122*gambarinv22 + gambarinv00*(GambarLLL000*GambarULL001 + GambarLLL100*GambarULL000) + gambarinv00*(GambarLLL010*GambarULL101 + GambarLLL110*GambarULL100) + gambarinv00*(GambarLLL020*GambarULL201 + GambarLLL120*GambarULL200) + gambarinv01*(GambarLLL001*GambarULL001 + GambarLLL101*GambarULL000) + gambarinv01*(GambarLLL011*GambarULL101 + GambarLLL111*GambarULL100) + gambarinv01*(GambarLLL021*GambarULL201 + GambarLLL121*GambarULL200) + gambarinv02*(GambarLLL002*GambarULL001 + GambarLLL102*GambarULL000) + gambarinv02*(GambarLLL012*GambarULL101 + GambarLLL112*GambarULL100) + gambarinv02*(GambarLLL022*GambarULL201 + GambarLLL122*GambarULL200) + gambarinv10*(GambarLLL000*GambarULL011 + GambarLLL100*GambarULL010) + gambarinv10*(GambarLLL010*GambarULL111 + GambarLLL110*GambarULL110) + gambarinv10*(GambarLLL020*GambarULL211 + GambarLLL120*GambarULL210) + gambarinv11*(GambarLLL001*GambarULL011 + GambarLLL101*GambarULL010) + gambarinv11*(GambarLLL011*GambarULL111 + GambarLLL111*GambarULL110) + gambarinv11*(GambarLLL021*GambarULL211 + GambarLLL121*GambarULL210) + gambarinv12*(GambarLLL002*GambarULL011 + GambarLLL102*GambarULL010) + gambarinv12*(GambarLLL012*GambarULL111 + GambarLLL112*GambarULL110) + gambarinv12*(GambarLLL022*GambarULL211 + GambarLLL122*GambarULL210) + gambarinv20*(GambarLLL000*GambarULL021 + GambarLLL100*GambarULL020) + gambarinv20*(GambarLLL010*GambarULL121 + GambarLLL110*GambarULL120) + gambarinv20*(GambarLLL020*GambarULL221 + GambarLLL120*GambarULL220) + gambarinv21*(GambarLLL001*GambarULL021 + GambarLLL101*GambarULL020) + gambarinv21*(GambarLLL011*GambarULL121 + GambarLLL111*GambarULL120) + gambarinv21*(GambarLLL021*GambarULL221 + GambarLLL121*GambarULL220) + gambarinv22*(GambarLLL002*GambarULL021 + GambarLLL102*GambarULL020) + gambarinv22*(GambarLLL012*GambarULL121 + GambarLLL112*GambarULL120) + gambarinv22*(GambarLLL022*GambarULL221 + GambarLLL122*GambarULL220);
         amrex::Real RbarLL02 = GambarLLL002*GambarULL000*gambarinv00 + GambarLLL002*GambarULL001*gambarinv01 + GambarLLL002*GambarULL002*gambarinv02 + GambarLLL012*GambarULL000*gambarinv10 + GambarLLL012*GambarULL001*gambarinv11 + GambarLLL012*GambarULL002*gambarinv12 + GambarLLL022*GambarULL000*gambarinv20 + GambarLLL022*GambarULL001*gambarinv21 + GambarLLL022*GambarULL002*gambarinv22 + GambarLLL102*GambarULL100*gambarinv00 + GambarLLL102*GambarULL101*gambarinv01 + GambarLLL102*GambarULL102*gambarinv02 + GambarLLL112*GambarULL100*gambarinv10 + GambarLLL112*GambarULL101*gambarinv11 + GambarLLL112*GambarULL102*gambarinv12 + GambarLLL122*GambarULL100*gambarinv20 + GambarLLL122*GambarULL101*gambarinv21 + GambarLLL122*GambarULL102*gambarinv22 + GambarLLL202*GambarULL200*gambarinv00 + GambarLLL202*GambarULL201*gambarinv01 + GambarLLL202*GambarULL202*gambarinv02 + GambarLLL212*GambarULL200*gambarinv10 + GambarLLL212*GambarULL201*gambarinv11 + GambarLLL212*GambarULL202*gambarinv12 + GambarLLL222*GambarULL200*gambarinv20 + GambarLLL222*GambarULL201*gambarinv21 + GambarLLL222*GambarULL202*gambarinv22 + 0.5*GambarU0*(GambarLLL020 + GambarLLL200) + 0.5*GambarU1*(GambarLLL021 + GambarLLL201) + 0.5*GambarU2*(GambarLLL022 + GambarLLL202) + 0.5*dGambarU00*gambar02 + 0.5*dGambarU02*gambar00 + 0.5*dGambarU10*gambar12 + 0.5*dGambarU12*gambar10 + 0.5*dGambarU20*gambar22 + 0.5*dGambarU22*gambar20 - 0.5*ddgambar0200*gambarinv00 - 0.5*ddgambar0201*gambarinv01 - 0.5*ddgambar0202*gambarinv02 - 0.5*ddgambar0210*gambarinv10 - 0.5*ddgambar0211*gambarinv11 - 0.5*ddgambar0212*gambarinv12 - 0.5*ddgambar0220*gambarinv20 - 0.5*ddgambar0221*gambarinv21 - 0.5*ddgambar0222*gambarinv22 + gambarinv00*(GambarLLL000*GambarULL002 + GambarLLL200*GambarULL000) + gambarinv00*(GambarLLL010*GambarULL102 + GambarLLL210*GambarULL100) + gambarinv00*(GambarLLL020*GambarULL202 + GambarLLL220*GambarULL200) + gambarinv01*(GambarLLL001*GambarULL002 + GambarLLL201*GambarULL000) + gambarinv01*(GambarLLL011*GambarULL102 + GambarLLL211*GambarULL100) + gambarinv01*(GambarLLL021*GambarULL202 + GambarLLL221*GambarULL200) + gambarinv02*(GambarLLL002*GambarULL002 + GambarLLL202*GambarULL000) + gambarinv02*(GambarLLL012*GambarULL102 + GambarLLL212*GambarULL100) + gambarinv02*(GambarLLL022*GambarULL202 + GambarLLL222*GambarULL200) + gambarinv10*(GambarLLL000*GambarULL012 + GambarLLL200*GambarULL010) + gambarinv10*(GambarLLL010*GambarULL112 + GambarLLL210*GambarULL110) + gambarinv10*(GambarLLL020*GambarULL212 + GambarLLL220*GambarULL210) + gambarinv11*(GambarLLL001*GambarULL012 + GambarLLL201*GambarULL010) + gambarinv11*(GambarLLL011*GambarULL112 + GambarLLL211*GambarULL110) + gambarinv11*(GambarLLL021*GambarULL212 + GambarLLL221*GambarULL210) + gambarinv12*(GambarLLL002*GambarULL012 + GambarLLL202*GambarULL010) + gambarinv12*(GambarLLL012*GambarULL112 + GambarLLL212*GambarULL110) + gambarinv12*(GambarLLL022*GambarULL212 + GambarLLL222*GambarULL210) + gambarinv20*(GambarLLL000*GambarULL022 + GambarLLL200*GambarULL020) + gambarinv20*(GambarLLL010*GambarULL122 + GambarLLL210*GambarULL120) + gambarinv20*(GambarLLL020*GambarULL222 + GambarLLL220*GambarULL220) + gambarinv21*(GambarLLL001*GambarULL022 + GambarLLL201*GambarULL020) + gambarinv21*(GambarLLL011*GambarULL122 + GambarLLL211*GambarULL120) + gambarinv21*(GambarLLL021*GambarULL222 + GambarLLL221*GambarULL220) + gambarinv22*(GambarLLL002*GambarULL022 + GambarLLL202*GambarULL020) + gambarinv22*(GambarLLL012*GambarULL122 + GambarLLL212*GambarULL120) + gambarinv22*(GambarLLL022*GambarULL222 + GambarLLL222*GambarULL220);
         amrex::Real RbarLL10 = GambarLLL000*GambarULL010*gambarinv00 + GambarLLL000*GambarULL011*gambarinv01 + GambarLLL000*GambarULL012*gambarinv02 + GambarLLL010*GambarULL010*gambarinv10 + GambarLLL010*GambarULL011*gambarinv11 + GambarLLL010*GambarULL012*gambarinv12 + GambarLLL020*GambarULL010*gambarinv20 + GambarLLL020*GambarULL011*gambarinv21 + GambarLLL020*GambarULL012*gambarinv22 + GambarLLL100*GambarULL110*gambarinv00 + GambarLLL100*GambarULL111*gambarinv01 + GambarLLL100*GambarULL112*gambarinv02 + GambarLLL110*GambarULL110*gambarinv10 + GambarLLL110*GambarULL111*gambarinv11 + GambarLLL110*GambarULL112*gambarinv12 + GambarLLL120*GambarULL110*gambarinv20 + GambarLLL120*GambarULL111*gambarinv21 + GambarLLL120*GambarULL112*gambarinv22 + GambarLLL200*GambarULL210*gambarinv00 + GambarLLL200*GambarULL211*gambarinv01 + GambarLLL200*GambarULL212*gambarinv02 + GambarLLL210*GambarULL210*gambarinv10 + GambarLLL210*GambarULL211*gambarinv11 + GambarLLL210*GambarULL212*gambarinv12 + GambarLLL220*GambarULL210*gambarinv20 + GambarLLL220*GambarULL211*gambarinv21 + GambarLLL220*GambarULL212*gambarinv22 + 0.5*GambarU0*(GambarLLL010 + GambarLLL100) + 0.5*GambarU1*(GambarLLL011 + GambarLLL101) + 0.5*GambarU2*(GambarLLL012 + GambarLLL102) + 0.5*dGambarU00*gambar01 + 0.5*dGambarU01*gambar00 + 0.5*dGambarU10*gambar11 + 0.5*dGambarU11*gambar10 + 0.5*dGambarU20*gambar21 + 0.5*dGambarU21*gambar20 - 0.5*ddgambar1000*gambarinv00 - 0.5*ddgambar1001*gambarinv01 - 0.5*ddgambar1002*gambarinv02 - 0.5*ddgambar1010*gambarinv10 - 0.5*ddgambar1011*gambarinv11 - 0.5*ddgambar1012*gambarinv12 - 0.5*ddgambar1020*gambarinv20 - 0.5*ddgambar1021*gambarinv21 - 0.5*ddgambar1022*gambarinv22 + gambarinv00*(GambarLLL000*GambarULL001 + GambarLLL100*GambarULL000) + gambarinv00*(GambarLLL010*GambarULL101 + GambarLLL110*GambarULL100) + gambarinv00*(GambarLLL020*GambarULL201 + GambarLLL120*GambarULL200) + gambarinv01*(GambarLLL001*GambarULL001 + GambarLLL101*GambarULL000) + gambarinv01*(GambarLLL011*GambarULL101 + GambarLLL111*GambarULL100) + gambarinv01*(GambarLLL021*GambarULL201 + GambarLLL121*GambarULL200) + gambarinv02*(GambarLLL002*GambarULL001 + GambarLLL102*GambarULL000) + gambarinv02*(GambarLLL012*GambarULL101 + GambarLLL112*GambarULL100) + gambarinv02*(GambarLLL022*GambarULL201 + GambarLLL122*GambarULL200) + gambarinv10*(GambarLLL000*GambarULL011 + GambarLLL100*GambarULL010) + gambarinv10*(GambarLLL010*GambarULL111 + GambarLLL110*GambarULL110) + gambarinv10*(GambarLLL020*GambarULL211 + GambarLLL120*GambarULL210) + gambarinv11*(GambarLLL001*GambarULL011 + GambarLLL101*GambarULL010) + gambarinv11*(GambarLLL011*GambarULL111 + GambarLLL111*GambarULL110) + gambarinv11*(GambarLLL021*GambarULL211 + GambarLLL121*GambarULL210) + gambarinv12*(GambarLLL002*GambarULL011 + GambarLLL102*GambarULL010) + gambarinv12*(GambarLLL012*GambarULL111 + GambarLLL112*GambarULL110) + gambarinv12*(GambarLLL022*GambarULL211 + GambarLLL122*GambarULL210) + gambarinv20*(GambarLLL000*GambarULL021 + GambarLLL100*GambarULL020) + gambarinv20*(GambarLLL010*GambarULL121 + GambarLLL110*GambarULL120) + gambarinv20*(GambarLLL020*GambarULL221 + GambarLLL120*GambarULL220) + gambarinv21*(GambarLLL001*GambarULL021 + GambarLLL101*GambarULL020) + gambarinv21*(GambarLLL011*GambarULL121 + GambarLLL111*GambarULL120) + gambarinv21*(GambarLLL021*GambarULL221 + GambarLLL121*GambarULL220) + gambarinv22*(GambarLLL002*GambarULL021 + GambarLLL102*GambarULL020) + gambarinv22*(GambarLLL012*GambarULL121 + GambarLLL112*GambarULL120) + gambarinv22*(GambarLLL022*GambarULL221 + GambarLLL122*GambarULL220);
         amrex::Real RbarLL11 = GambarLLL001*GambarULL010*gambarinv00 + GambarLLL001*GambarULL011*gambarinv01 + GambarLLL001*GambarULL012*gambarinv02 + GambarLLL011*GambarULL010*gambarinv10 + GambarLLL011*GambarULL011*gambarinv11 + GambarLLL011*GambarULL012*gambarinv12 + GambarLLL021*GambarULL010*gambarinv20 + GambarLLL021*GambarULL011*gambarinv21 + GambarLLL021*GambarULL012*gambarinv22 + 2*GambarLLL100*GambarULL001*gambarinv00 + 2*GambarLLL100*GambarULL011*gambarinv10 + 2*GambarLLL100*GambarULL021*gambarinv20 + 2*GambarLLL101*GambarULL001*gambarinv01 + 2*GambarLLL101*GambarULL011*gambarinv11 + 2*GambarLLL101*GambarULL021*gambarinv21 + GambarLLL101*GambarULL110*gambarinv00 + GambarLLL101*GambarULL111*gambarinv01 + GambarLLL101*GambarULL112*gambarinv02 + 2*GambarLLL102*GambarULL001*gambarinv02 + 2*GambarLLL102*GambarULL011*gambarinv12 + 2*GambarLLL102*GambarULL021*gambarinv22 + 1.0*GambarLLL110*GambarU0 + 2*GambarLLL110*GambarULL101*gambarinv00 + 2*GambarLLL110*GambarULL111*gambarinv10 + 2*GambarLLL110*GambarULL121*gambarinv20 + 1.0*GambarLLL111*GambarU1 + 2*GambarLLL111*GambarULL101*gambarinv01 + GambarLLL111*GambarULL110*gambarinv10 + 3*GambarLLL111*GambarULL111*gambarinv11 + GambarLLL111*GambarULL112*gambarinv12 + 2*GambarLLL111*GambarULL121*gambarinv21 + 1.0*GambarLLL112*GambarU2 + 2*GambarLLL112*GambarULL101*gambarinv02 + 2*GambarLLL112*GambarULL111*gambarinv12 + 2*GambarLLL112*GambarULL121*gambarinv22 + 2*GambarLLL120*GambarULL201*gambarinv00 + 2*GambarLLL120*GambarULL211*gambarinv10 + 2*GambarLLL120*GambarULL221*gambarinv20 + GambarLLL121*GambarULL110*gambarinv20 + GambarLLL121*GambarULL111*gambarinv21 + GambarLLL121*GambarULL112*gambarinv22 + 2*GambarLLL121*GambarULL201*gambarinv01 + 2*GambarLLL121*GambarULL211*gambarinv11 + 2*GambarLLL121*GambarULL221*gambarinv21 + 2*GambarLLL122*GambarULL201*gambarinv02 + 2*GambarLLL122*GambarULL211*gambarinv12 + 2*GambarLLL122*GambarULL221*gambarinv22 + GambarLLL201*GambarULL210*gambarinv00 + GambarLLL201*GambarULL211*gambarinv01 + GambarLLL201*GambarULL212*gambarinv02 + GambarLLL211*GambarULL210*gambarinv10 + GambarLLL211*GambarULL211*gambarinv11 + GambarLLL211*GambarULL212*gambarinv12 + GambarLLL221*GambarULL210*gambarinv20 + GambarLLL221*GambarULL211*gambarinv21 + GambarLLL221*GambarULL212*gambarinv22 + 1.0*dGambarU01*gambar01 + 1.0*dGambarU11*gambar11 + 1.0*dGambarU21*gambar21 - 0.5*ddgambar1100*gambarinv00 - 0.5*ddgambar1101*gambarinv01 - 0.5*ddgambar1102*gambarinv02 - 0.5*ddgambar1110*gambarinv10 - 0.5*ddgambar1111*gambarinv11 - 0.5*ddgambar1112*gambarinv12 - 0.5*ddgambar1120*gambarinv20 - 0.5*ddgambar1121*gambarinv21 - 0.5*ddgambar1122*gambarinv22;
         amrex::Real RbarLL12 = GambarLLL002*GambarULL010*gambarinv00 + GambarLLL002*GambarULL011*gambarinv01 + GambarLLL002*GambarULL012*gambarinv02 + GambarLLL012*GambarULL010*gambarinv10 + GambarLLL012*GambarULL011*gambarinv11 + GambarLLL012*GambarULL012*gambarinv12 + GambarLLL022*GambarULL010*gambarinv20 + GambarLLL022*GambarULL011*gambarinv21 + GambarLLL022*GambarULL012*gambarinv22 + GambarLLL102*GambarULL110*gambarinv00 + GambarLLL102*GambarULL111*gambarinv01 + GambarLLL102*GambarULL112*gambarinv02 + GambarLLL112*GambarULL110*gambarinv10 + GambarLLL112*GambarULL111*gambarinv11 + GambarLLL112*GambarULL112*gambarinv12 + GambarLLL122*GambarULL110*gambarinv20 + GambarLLL122*GambarULL111*gambarinv21 + GambarLLL122*GambarULL112*gambarinv22 + GambarLLL202*GambarULL210*gambarinv00 + GambarLLL202*GambarULL211*gambarinv01 + GambarLLL202*GambarULL212*gambarinv02 + GambarLLL212*GambarULL210*gambarinv10 + GambarLLL212*GambarULL211*gambarinv11 + GambarLLL212*GambarULL212*gambarinv12 + GambarLLL222*GambarULL210*gambarinv20 + GambarLLL222*GambarULL211*gambarinv21 + GambarLLL222*GambarULL212*gambarinv22 + 0.5*GambarU0*(GambarLLL120 + GambarLLL210) + 0.5*GambarU1*(GambarLLL121 + GambarLLL211) + 0.5*GambarU2*(GambarLLL122 + GambarLLL212) + 0.5*dGambarU01*gambar02 + 0.5*dGambarU02*gambar01 + 0.5*dGambarU11*gambar12 + 0.5*dGambarU12*gambar11 + 0.5*dGambarU21*gambar22 + 0.5*dGambarU22*gambar21 - 0.5*ddgambar1200*gambarinv00 - 0.5*ddgambar1201*gambarinv01 - 0.5*ddgambar1202*gambarinv02 - 0.5*ddgambar1210*gambarinv10 - 0.5*ddgambar1211*gambarinv11 - 0.5*ddgambar1212*gambarinv12 - 0.5*ddgambar1220*gambarinv20 - 0.5*ddgambar1221*gambarinv21 - 0.5*ddgambar1222*gambarinv22 + gambarinv00*(GambarLLL100*GambarULL002 + GambarLLL200*GambarULL001) + gambarinv00*(GambarLLL110*GambarULL102 + GambarLLL210*GambarULL101) + gambarinv00*(GambarLLL120*GambarULL202 + GambarLLL220*GambarULL201) + gambarinv01*(GambarLLL101*GambarULL002 + GambarLLL201*GambarULL001) + gambarinv01*(GambarLLL111*GambarULL102 + GambarLLL211*GambarULL101) + gambarinv01*(GambarLLL121*GambarULL202 + GambarLLL221*GambarULL201) + gambarinv02*(GambarLLL102*GambarULL002 + GambarLLL202*GambarULL001) + gambarinv02*(GambarLLL112*GambarULL102 + GambarLLL212*GambarULL101) + gambarinv02*(GambarLLL122*GambarULL202 + GambarLLL222*GambarULL201) + gambarinv10*(GambarLLL100*GambarULL012 + GambarLLL200*GambarULL011) + gambarinv10*(GambarLLL110*GambarULL112 + GambarLLL210*GambarULL111) + gambarinv10*(GambarLLL120*GambarULL212 + GambarLLL220*GambarULL211) + gambarinv11*(GambarLLL101*GambarULL012 + GambarLLL201*GambarULL011) + gambarinv11*(GambarLLL111*GambarULL112 + GambarLLL211*GambarULL111) + gambarinv11*(GambarLLL121*GambarULL212 + GambarLLL221*GambarULL211) + gambarinv12*(GambarLLL102*GambarULL012 + GambarLLL202*GambarULL011) + gambarinv12*(GambarLLL112*GambarULL112 + GambarLLL212*GambarULL111) + gambarinv12*(GambarLLL122*GambarULL212 + GambarLLL222*GambarULL211) + gambarinv20*(GambarLLL100*GambarULL022 + GambarLLL200*GambarULL021) + gambarinv20*(GambarLLL110*GambarULL122 + GambarLLL210*GambarULL121) + gambarinv20*(GambarLLL120*GambarULL222 + GambarLLL220*GambarULL221) + gambarinv21*(GambarLLL101*GambarULL022 + GambarLLL201*GambarULL021) + gambarinv21*(GambarLLL111*GambarULL122 + GambarLLL211*GambarULL121) + gambarinv21*(GambarLLL121*GambarULL222 + GambarLLL221*GambarULL221) + gambarinv22*(GambarLLL102*GambarULL022 + GambarLLL202*GambarULL021) + gambarinv22*(GambarLLL112*GambarULL122 + GambarLLL212*GambarULL121) + gambarinv22*(GambarLLL122*GambarULL222 + GambarLLL222*GambarULL221);
         amrex::Real RbarLL20 = GambarLLL000*GambarULL020*gambarinv00 + GambarLLL000*GambarULL021*gambarinv01 + GambarLLL000*GambarULL022*gambarinv02 + GambarLLL010*GambarULL020*gambarinv10 + GambarLLL010*GambarULL021*gambarinv11 + GambarLLL010*GambarULL022*gambarinv12 + GambarLLL020*GambarULL020*gambarinv20 + GambarLLL020*GambarULL021*gambarinv21 + GambarLLL020*GambarULL022*gambarinv22 + GambarLLL100*GambarULL120*gambarinv00 + GambarLLL100*GambarULL121*gambarinv01 + GambarLLL100*GambarULL122*gambarinv02 + GambarLLL110*GambarULL120*gambarinv10 + GambarLLL110*GambarULL121*gambarinv11 + GambarLLL110*GambarULL122*gambarinv12 + GambarLLL120*GambarULL120*gambarinv20 + GambarLLL120*GambarULL121*gambarinv21 + GambarLLL120*GambarULL122*gambarinv22 + GambarLLL200*GambarULL220*gambarinv00 + GambarLLL200*GambarULL221*gambarinv01 + GambarLLL200*GambarULL222*gambarinv02 + GambarLLL210*GambarULL220*gambarinv10 + GambarLLL210*GambarULL221*gambarinv11 + GambarLLL210*GambarULL222*gambarinv12 + GambarLLL220*GambarULL220*gambarinv20 + GambarLLL220*GambarULL221*gambarinv21 + GambarLLL220*GambarULL222*gambarinv22 + 0.5*GambarU0*(GambarLLL020 + GambarLLL200) + 0.5*GambarU1*(GambarLLL021 + GambarLLL201) + 0.5*GambarU2*(GambarLLL022 + GambarLLL202) + 0.5*dGambarU00*gambar02 + 0.5*dGambarU02*gambar00 + 0.5*dGambarU10*gambar12 + 0.5*dGambarU12*gambar10 + 0.5*dGambarU20*gambar22 + 0.5*dGambarU22*gambar20 - 0.5*ddgambar2000*gambarinv00 - 0.5*ddgambar2001*gambarinv01 - 0.5*ddgambar2002*gambarinv02 - 0.5*ddgambar2010*gambarinv10 - 0.5*ddgambar2011*gambarinv11 - 0.5*ddgambar2012*gambarinv12 - 0.5*ddgambar2020*gambarinv20 - 0.5*ddgambar2021*gambarinv21 - 0.5*ddgambar2022*gambarinv22 + gambarinv00*(GambarLLL000*GambarULL002 + GambarLLL200*GambarULL000) + gambarinv00*(GambarLLL010*GambarULL102 + GambarLLL210*GambarULL100) + gambarinv00*(GambarLLL020*GambarULL202 + GambarLLL220*GambarULL200) + gambarinv01*(GambarLLL001*GambarULL002 + GambarLLL201*GambarULL000) + gambarinv01*(GambarLLL011*GambarULL102 + GambarLLL211*GambarULL100) + gambarinv01*(GambarLLL021*GambarULL202 + GambarLLL221*GambarULL200) + gambarinv02*(GambarLLL002*GambarULL002 + GambarLLL202*GambarULL000) + gambarinv02*(GambarLLL012*GambarULL102 + GambarLLL212*GambarULL100) + gambarinv02*(GambarLLL022*GambarULL202 + GambarLLL222*GambarULL200) + gambarinv10*(GambarLLL000*GambarULL012 + GambarLLL200*GambarULL010) + gambarinv10*(GambarLLL010*GambarULL112 + GambarLLL210*GambarULL110) + gambarinv10*(GambarLLL020*GambarULL212 + GambarLLL220*GambarULL210) + gambarinv11*(GambarLLL001*GambarULL012 + GambarLLL201*GambarULL010) + gambarinv11*(GambarLLL011*GambarULL112 + GambarLLL211*GambarULL110) + gambarinv11*(GambarLLL021*GambarULL212 + GambarLLL221*GambarULL210) + gambarinv12*(GambarLLL002*GambarULL012 + GambarLLL202*GambarULL010) + gambarinv12*(GambarLLL012*GambarULL112 + GambarLLL212*GambarULL110) + gambarinv12*(GambarLLL022*GambarULL212 + GambarLLL222*GambarULL210) + gambarinv20*(GambarLLL000*GambarULL022 + GambarLLL200*GambarULL020) + gambarinv20*(GambarLLL010*GambarULL122 + GambarLLL210*GambarULL120) + gambarinv20*(GambarLLL020*GambarULL222 + GambarLLL220*GambarULL220) + gambarinv21*(GambarLLL001*GambarULL022 + GambarLLL201*GambarULL020) + gambarinv21*(GambarLLL011*GambarULL122 + GambarLLL211*GambarULL120) + gambarinv21*(GambarLLL021*GambarULL222 + GambarLLL221*GambarULL220) + gambarinv22*(GambarLLL002*GambarULL022 + GambarLLL202*GambarULL020) + gambarinv22*(GambarLLL012*GambarULL122 + GambarLLL212*GambarULL120) + gambarinv22*(GambarLLL022*GambarULL222 + GambarLLL222*GambarULL220);
         amrex::Real RbarLL21 = GambarLLL001*GambarULL020*gambarinv00 + GambarLLL001*GambarULL021*gambarinv01 + GambarLLL001*GambarULL022*gambarinv02 + GambarLLL011*GambarULL020*gambarinv10 + GambarLLL011*GambarULL021*gambarinv11 + GambarLLL011*GambarULL022*gambarinv12 + GambarLLL021*GambarULL020*gambarinv20 + GambarLLL021*GambarULL021*gambarinv21 + GambarLLL021*GambarULL022*gambarinv22 + GambarLLL101*GambarULL120*gambarinv00 + GambarLLL101*GambarULL121*gambarinv01 + GambarLLL101*GambarULL122*gambarinv02 + GambarLLL111*GambarULL120*gambarinv10 + GambarLLL111*GambarULL121*gambarinv11 + GambarLLL111*GambarULL122*gambarinv12 + GambarLLL121*GambarULL120*gambarinv20 + GambarLLL121*GambarULL121*gambarinv21 + GambarLLL121*GambarULL122*gambarinv22 + GambarLLL201*GambarULL220*gambarinv00 + GambarLLL201*GambarULL221*gambarinv01 + GambarLLL201*GambarULL222*gambarinv02 + GambarLLL211*GambarULL220*gambarinv10 + GambarLLL211*GambarULL221*gambarinv11 + GambarLLL211*GambarULL222*gambarinv12 + GambarLLL221*GambarULL220*gambarinv20 + GambarLLL221*GambarULL221*gambarinv21 + GambarLLL221*GambarULL222*gambarinv22 + 0.5*GambarU0*(GambarLLL120 + GambarLLL210) + 0.5*GambarU1*(GambarLLL121 + GambarLLL211) + 0.5*GambarU2*(GambarLLL122 + GambarLLL212) + 0.5*dGambarU01*gambar02 + 0.5*dGambarU02*gambar01 + 0.5*dGambarU11*gambar12 + 0.5*dGambarU12*gambar11 + 0.5*dGambarU21*gambar22 + 0.5*dGambarU22*gambar21 - 0.5*ddgambar2100*gambarinv00 - 0.5*ddgambar2101*gambarinv01 - 0.5*ddgambar2102*gambarinv02 - 0.5*ddgambar2110*gambarinv10 - 0.5*ddgambar2111*gambarinv11 - 0.5*ddgambar2112*gambarinv12 - 0.5*ddgambar2120*gambarinv20 - 0.5*ddgambar2121*gambarinv21 - 0.5*ddgambar2122*gambarinv22 + gambarinv00*(GambarLLL100*GambarULL002 + GambarLLL200*GambarULL001) + gambarinv00*(GambarLLL110*GambarULL102 + GambarLLL210*GambarULL101) + gambarinv00*(GambarLLL120*GambarULL202 + GambarLLL220*GambarULL201) + gambarinv01*(GambarLLL101*GambarULL002 + GambarLLL201*GambarULL001) + gambarinv01*(GambarLLL111*GambarULL102 + GambarLLL211*GambarULL101) + gambarinv01*(GambarLLL121*GambarULL202 + GambarLLL221*GambarULL201) + gambarinv02*(GambarLLL102*GambarULL002 + GambarLLL202*GambarULL001) + gambarinv02*(GambarLLL112*GambarULL102 + GambarLLL212*GambarULL101) + gambarinv02*(GambarLLL122*GambarULL202 + GambarLLL222*GambarULL201) + gambarinv10*(GambarLLL100*GambarULL012 + GambarLLL200*GambarULL011) + gambarinv10*(GambarLLL110*GambarULL112 + GambarLLL210*GambarULL111) + gambarinv10*(GambarLLL120*GambarULL212 + GambarLLL220*GambarULL211) + gambarinv11*(GambarLLL101*GambarULL012 + GambarLLL201*GambarULL011) + gambarinv11*(GambarLLL111*GambarULL112 + GambarLLL211*GambarULL111) + gambarinv11*(GambarLLL121*GambarULL212 + GambarLLL221*GambarULL211) + gambarinv12*(GambarLLL102*GambarULL012 + GambarLLL202*GambarULL011) + gambarinv12*(GambarLLL112*GambarULL112 + GambarLLL212*GambarULL111) + gambarinv12*(GambarLLL122*GambarULL212 + GambarLLL222*GambarULL211) + gambarinv20*(GambarLLL100*GambarULL022 + GambarLLL200*GambarULL021) + gambarinv20*(GambarLLL110*GambarULL122 + GambarLLL210*GambarULL121) + gambarinv20*(GambarLLL120*GambarULL222 + GambarLLL220*GambarULL221) + gambarinv21*(GambarLLL101*GambarULL022 + GambarLLL201*GambarULL021) + gambarinv21*(GambarLLL111*GambarULL122 + GambarLLL211*GambarULL121) + gambarinv21*(GambarLLL121*GambarULL222 + GambarLLL221*GambarULL221) + gambarinv22*(GambarLLL102*GambarULL022 + GambarLLL202*GambarULL021) + gambarinv22*(GambarLLL112*GambarULL122 + GambarLLL212*GambarULL121) + gambarinv22*(GambarLLL122*GambarULL222 + GambarLLL222*GambarULL221);
         amrex::Real RbarLL22 = GambarLLL002*GambarULL020*gambarinv00 + GambarLLL002*GambarULL021*gambarinv01 + GambarLLL002*GambarULL022*gambarinv02 + GambarLLL012*GambarULL020*gambarinv10 + GambarLLL012*GambarULL021*gambarinv11 + GambarLLL012*GambarULL022*gambarinv12 + GambarLLL022*GambarULL020*gambarinv20 + GambarLLL022*GambarULL021*gambarinv21 + GambarLLL022*GambarULL022*gambarinv22 + GambarLLL102*GambarULL120*gambarinv00 + GambarLLL102*GambarULL121*gambarinv01 + GambarLLL102*GambarULL122*gambarinv02 + GambarLLL112*GambarULL120*gambarinv10 + GambarLLL112*GambarULL121*gambarinv11 + GambarLLL112*GambarULL122*gambarinv12 + GambarLLL122*GambarULL120*gambarinv20 + GambarLLL122*GambarULL121*gambarinv21 + GambarLLL122*GambarULL122*gambarinv22 + 2*GambarLLL200*GambarULL002*gambarinv00 + 2*GambarLLL200*GambarULL012*gambarinv10 + 2*GambarLLL200*GambarULL022*gambarinv20 + 2*GambarLLL201*GambarULL002*gambarinv01 + 2*GambarLLL201*GambarULL012*gambarinv11 + 2*GambarLLL201*GambarULL022*gambarinv21 + 2*GambarLLL202*GambarULL002*gambarinv02 + 2*GambarLLL202*GambarULL012*gambarinv12 + 2*GambarLLL202*GambarULL022*gambarinv22 + GambarLLL202*GambarULL220*gambarinv00 + GambarLLL202*GambarULL221*gambarinv01 + GambarLLL202*GambarULL222*gambarinv02 + 2*GambarLLL210*GambarULL102*gambarinv00 + 2*GambarLLL210*GambarULL112*gambarinv10 + 2*GambarLLL210*GambarULL122*gambarinv20 + 2*GambarLLL211*GambarULL102*gambarinv01 + 2*GambarLLL211*GambarULL112*gambarinv11 + 2*GambarLLL211*GambarULL122*gambarinv21 + 2*GambarLLL212*GambarULL102*gambarinv02 + 2*GambarLLL212*GambarULL112*gambarinv12 + 2*GambarLLL212*GambarULL122*gambarinv22 + GambarLLL212*GambarULL220*gambarinv10 + GambarLLL212*GambarULL221*gambarinv11 + GambarLLL212*GambarULL222*gambarinv12 + 1.0*GambarLLL220*GambarU0 + 2*GambarLLL220*GambarULL202*gambarinv00 + 2*GambarLLL220*GambarULL212*gambarinv10 + 2*GambarLLL220*GambarULL222*gambarinv20 + 1.0*GambarLLL221*GambarU1 + 2*GambarLLL221*GambarULL202*gambarinv01 + 2*GambarLLL221*GambarULL212*gambarinv11 + 2*GambarLLL221*GambarULL222*gambarinv21 + 1.0*GambarLLL222*GambarU2 + 2*GambarLLL222*GambarULL202*gambarinv02 + 2*GambarLLL222*GambarULL212*gambarinv12 + GambarLLL222*GambarULL220*gambarinv20 + GambarLLL222*GambarULL221*gambarinv21 + 3*GambarLLL222*GambarULL222*gambarinv22 + 1.0*dGambarU02*gambar02 + 1.0*dGambarU12*gambar12 + 1.0*dGambarU22*gambar22 - 0.5*ddgambar2200*gambarinv00 - 0.5*ddgambar2201*gambarinv01 - 0.5*ddgambar2202*gambarinv02 - 0.5*ddgambar2210*gambarinv10 - 0.5*ddgambar2211*gambarinv11 - 0.5*ddgambar2212*gambarinv12 - 0.5*ddgambar2220*gambarinv20 - 0.5*ddgambar2221*gambarinv21 - 0.5*ddgambar2222*gambarinv22;
	 amrex::Real Rbarsclr = RbarLL00*gambarinv00 + RbarLL01*gambarinv01 + RbarLL02*gambarinv02 + RbarLL10*gambarinv10 + RbarLL11*gambarinv11 + RbarLL12*gambarinv12 + RbarLL20*gambarinv20 + RbarLL21*gambarinv21 + RbarLL22*gambarinv22;
	 
         // The H diagnostic
  diag(i, j, k, Diag::H) = (1.0/8.0)*Abar00*AbarUU00*std::exp(5*phi) + (1.0/8.0)*Abar01*AbarUU01*std::exp(5*phi) + (1.0/8.0)*Abar02*AbarUU02*std::exp(5*phi) + (1.0/8.0)*Abar10*AbarUU10*std::exp(5*phi) + (1.0/8.0)*Abar11*AbarUU11*std::exp(5*phi) + (1.0/8.0)*Abar12*AbarUU12*std::exp(5*phi) + (1.0/8.0)*Abar20*AbarUU20*std::exp(5*phi) + (1.0/8.0)*Abar21*AbarUU21*std::exp(5*phi) + (1.0/8.0)*Abar22*AbarUU22*std::exp(5*phi) - 1.0/12.0*std::pow(Ksclr, 2)*std::exp(phi) + (1.0/8.0)*Rbarsclr*std::exp(phi) + gambarinv00*(GambarULL000*dphi0 + GambarULL100*dphi1 + GambarULL200*dphi2 + 2*ddphi00)*std::exp(phi) + gambarinv01*(GambarULL001*dphi0 + GambarULL101*dphi1 + GambarULL201*dphi2 + 2*ddphi01)*std::exp(phi) + gambarinv02*(GambarULL002*dphi0 + GambarULL102*dphi1 + GambarULL202*dphi2 + 2*ddphi02)*std::exp(phi) + gambarinv10*(GambarULL010*dphi0 + GambarULL110*dphi1 + GambarULL210*dphi2 + 2*ddphi10)*std::exp(phi) + gambarinv11*(GambarULL011*dphi0 + GambarULL111*dphi1 + GambarULL211*dphi2 + 2*ddphi11)*std::exp(phi) + gambarinv12*(GambarULL012*dphi0 + GambarULL112*dphi1 + GambarULL212*dphi2 + 2*ddphi12)*std::exp(phi) + gambarinv20*(GambarULL020*dphi0 + GambarULL120*dphi1 + GambarULL220*dphi2 + 2*ddphi20)*std::exp(phi) + gambarinv21*(GambarULL021*dphi0 + GambarULL121*dphi1 + GambarULL221*dphi2 + 2*ddphi21)*std::exp(phi) + gambarinv22*(GambarULL022*dphi0 + GambarULL122*dphi1 + GambarULL222*dphi2 + 2*ddphi22)*std::exp(phi);
}
#endif
